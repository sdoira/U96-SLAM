//=============================================================================
// Copyright (C) 2020 Nu-Gate Technology. All rights reserved.
// SPDX-License-Identifier: MIT
//=============================================================================
//=============================================================================
//!
//! @file ov5640.c
//!
//! This file contains the functions regarding to the manipulations of
//! OV5640 CMOS sensor.
//!
//! <pre>
//! MODIFICATION HISTORY:
//!
//! Ver   Who  Date       Changes
//! ----- ---- ---------- -----------------------------------------------------
//! 1.0   sd   2020.12.07 First release
//! </pre>
//=============================================================================
#include "ov5640.h"

//=============================================================================
//! OV5640 Software Reset
//-----------------------------------------------------------------------------
//! @param mode		OV5640_RESET_ASSERT: assert reset,
//!            		OV5640_RESET_RELEASE: release reset
//-----------------------------------------------------------------------------
//! @brief This function asserts or de-asserts software reset to OV5640
//! depending on the value of "mode" parameter.
//=============================================================================
void Ov5640_SoftwareReset (int mode) {
	unsigned char reg_value;
	Ov5640_I2cRead(OV5640_ADDR_SYSTEM_CTROL0, &reg_value);

	if (mode == OV5640_RESET_ASSERT) {
		reg_value |= OV5640_SYSTEM_CTROL0_SOFTWARE_RESET;
	} else {
		reg_value &= ~OV5640_SYSTEM_CTROL0_SOFTWARE_RESET;
	}

	Ov5640_I2cWrite(OV5640_ADDR_SYSTEM_CTROL0, reg_value);
}

//=============================================================================
//! OV5640 Power Mode
//-----------------------------------------------------------------------------
//! @param mode		OV5640_POWER_UP: set to power up mode,
//!            		OV5640_POWER_DOWN: set to power down mode
//-----------------------------------------------------------------------------
//! @brief This function sets the power mode of OV5640 to power up state of
//! power down state depending on the value of "mode" parameter.
//=============================================================================
void Ov5640_PowerMode (int mode) {
	unsigned char reg_value;
	Ov5640_I2cRead(OV5640_ADDR_SYSTEM_CTROL0, &reg_value);

	if (mode == OV5640_POWER_DOWN) {
		reg_value |= OV5640_SYSTEM_CTROL0_SOFTWARE_POWERDOWN;
	} else {
		reg_value &= ~OV5640_SYSTEM_CTROL0_SOFTWARE_POWERDOWN;
	}

	Ov5640_I2cWrite(OV5640_ADDR_SYSTEM_CTROL0, reg_value);
}

//=============================================================================
//! OV5640 I2c Read
//-----------------------------------------------------------------------------
//! @param reg_addr		I2C register address
//! @param *reg_value	Read-out data is stored here
//-----------------------------------------------------------------------------
//! @brief This function reads 1 byte of data from the specified address
//! through I2C interface of OV5640.
//-----------------------------------------------------------------------------
//! @note Channel must be set properly in I2C expander (TCA9548A).
//=============================================================================
void Ov5640_I2cRead (unsigned int reg_addr, unsigned char *reg_value) {
	unsigned char tmp[2];
	tmp[0] = ((reg_addr >> 8) & 0xFF); // register address high byte
	tmp[1] =  (reg_addr       & 0xFF); // low byte

	I2c_Write(OV5640_I2C_ADDR, tmp, 2);

	I2c_Read(OV5640_I2C_ADDR, reg_value, 1);
}

//=============================================================================
//! OV5640 I2c Write
//-----------------------------------------------------------------------------
//! @param reg_addr		I2C register address
//! @param reg_value	Data to be written
//-----------------------------------------------------------------------------
//! @brief This function writes 1 byte of data to the specified address
//! through I2C interface of OV5640.
//-----------------------------------------------------------------------------
//! @note Channel must be set properly in I2C expander (TCA9548A).
//=============================================================================
void Sccb_Write (unsigned int data) {

	unsigned int reg_addr = (data >> 8) & 0xFFFF;
	unsigned char reg_value = data & 0xFF;

	Ov5640_I2cWrite(reg_addr, reg_value);
}

void Sccb_Read(unsigned long WrData, unsigned char *RdData){

	unsigned int reg_addr = (WrData >> 8) & 0xFFFF;

	Ov5640_I2cRead(reg_addr, RdData);
}

void AutoFocusOn(unsigned long cam) {
	unsigned char rddata;

	//Fpga_SetI2cMode(cam);

	Sccb_Write(0x78302301);
	Sccb_Write(0x78302204);
	do {
		Sccb_Read(0x78302300, &rddata);
	} while(rddata == 0x01);
}

void AutoFocusOff(unsigned long cam) {
	unsigned char rddata;

	//Fpga_SetI2cMode(cam);

	Sccb_Write(0x78302301);
	Sccb_Write(0x78302206);
	do {
		Sccb_Read(0x78302300, &rddata);
	} while(rddata == 0x01);
}

int Ov5640_Init2()
{
	/*
	Sccb_Write(0x78310311); // SCCB SYSTEM CTRL1
	Sccb_Write(0x78300882); // SYSTEM CTROL0
	Sccb_Write(0x78300842); // SYSTEM CTROL0
	//Sccb_Write(0x78300802); // SYSTEM CTROL0 (Added)
	Sccb_Write(0x78310303); // SCCB SYSTEM CTRL1
	Sccb_Write(0x78301700); // PAD OUTPUT ENABLE 01
	Sccb_Write(0x78301800); // PAD OUTPUT ENABLE 02
	//Sccb_Write(0x7830177F); // PAD OUTPUT ENABLE 01
	//Sccb_Write(0x783018FC); // PAD OUTPUT ENABLE 02
	Sccb_Write(0x78303418); // SC PLL CONTRL0
	Sccb_Write(0x78303638); // SC PLL CONTRL2
	Sccb_Write(0x78303713); // SC PLL CONTRL3
	*/
	Sccb_Write(0x78363036); // INVALID ADDRESS
	Sccb_Write(0x7836310E); // INVALID ADDRESS
	Sccb_Write(0x783632E2); // INVALID ADDRESS
	Sccb_Write(0x78363312); // INVALID ADDRESS
	Sccb_Write(0x783621E0); // INVALID ADDRESS
	Sccb_Write(0x783704A0); // INVALID ADDRESS
	Sccb_Write(0x7837035A); // INVALID ADDRESS
	Sccb_Write(0x78371578); // INVALID ADDRESS
	Sccb_Write(0x78371701); // INVALID ADDRESS
	Sccb_Write(0x78370B60); // INVALID ADDRESS
	Sccb_Write(0x7837051A); // INVALID ADDRESS
	Sccb_Write(0x78390502); // INVALID ADDRESS
	Sccb_Write(0x78390610); // INVALID ADDRESS
	Sccb_Write(0x7839010A); // INVALID ADDRESS
	Sccb_Write(0x78373112); // INVALID ADDRESS
	Sccb_Write(0x78360008); // DEBUG MODE
	Sccb_Write(0x78360133); // DEBUG MODE
	Sccb_Write(0x78302D60); // SYSTEM CONTROL
	Sccb_Write(0x78362052); // INVALID ADDRESS
	Sccb_Write(0x78371B20); // INVALID ADDRESS
	Sccb_Write(0x78471C50); // INVALID ADDRESS
	Sccb_Write(0x783A1343); // AEC CTRL13
	Sccb_Write(0x783A1800); // AEC GAIN CEILING
	Sccb_Write(0x783A19F8); // AEC GAIN CEILING
	Sccb_Write(0x78363513); // INVALID ADDRESS
	Sccb_Write(0x78363603); // INVALID ADDRESS
	Sccb_Write(0x78363440); // INVALID ADDRESS
	Sccb_Write(0x78362201); // INVALID ADDRESS
	Sccb_Write(0x783C01A4); // 5060HZ CTRL01
	Sccb_Write(0x783C0428); // 5060HZ CTRL04
	Sccb_Write(0x783C0598); // 5060HZ CTRL05
	Sccb_Write(0x783C0600); // LIGHT METER1 THRESHOLD
	Sccb_Write(0x783C0708); // LIGHT METER1 THRESHOLD
	Sccb_Write(0x783C0800); // LIGHT METER2 THRESHOLD
	Sccb_Write(0x783C091C); // LIGHT METER2 THRESHOLD
	Sccb_Write(0x783C0A9C); // SAMPLE NUMBER
	Sccb_Write(0x783C0B40); // SAMPLE NUMBER
	Sccb_Write(0x78382041); // TIMING TC REG20
	Sccb_Write(0x78382107); // TIMING TC REG21
	Sccb_Write(0x78381431); // TIMING X INC
	Sccb_Write(0x78381531); // TIMING Y INC
	Sccb_Write(0x78380000); // TIMING HS
	Sccb_Write(0x78380100); // TIMING HS
	Sccb_Write(0x78380200); // TIMING VS
	Sccb_Write(0x78380304); // TIMING VS
	Sccb_Write(0x7838040A); // TIMING HW
	Sccb_Write(0x7838053F); // TIMING HW
	Sccb_Write(0x78380607); // TIMING VH
	Sccb_Write(0x7838079B); // TIMING VH
	Sccb_Write(0x78381000); // TIMING HOFFSET
	Sccb_Write(0x78381110); // TIMING HOFFSET
	Sccb_Write(0x78381200); // TIMING VOFFSET
	Sccb_Write(0x78381306); // TIMING VOFFSET
	Sccb_Write(0x78361800); // INVALID ADDRESS
	Sccb_Write(0x78361229); // INVALID ADDRESS
	Sccb_Write(0x78370864); // INVALID ADDRESS
	Sccb_Write(0x78370952); // INVALID ADDRESS
	Sccb_Write(0x78370C03); // INVALID ADDRESS
	Sccb_Write(0x783A0203); // AEC MAX EXPO(60HZ)
	Sccb_Write(0x783A03D8); // AEC MAX EXPO(60HZ)
	Sccb_Write(0x783A0801); // AEC B50 STEP
	Sccb_Write(0x783A0927); // AEC B50 STEP
	Sccb_Write(0x783A0A00); // AEC B60 STEP
	Sccb_Write(0x783A0BF6); // AEC B60 STEP
	Sccb_Write(0x783A0E03); // AEC CTRL0E
	Sccb_Write(0x783A0D04); // AEC CTRL0D
	Sccb_Write(0x783A1403); // AEC MAX EXPO(50HZ)
	Sccb_Write(0x783A15D8); // AEC MAX EXPO(50HZ)
	Sccb_Write(0x78400102); // BLC CTRL01
	Sccb_Write(0x78400402); // BLC CTRL04
	/*
	Sccb_Write(0x78300000); // SYSTEM_RESET00
	Sccb_Write(0x7830021C); // SYSTEM RESET02
	Sccb_Write(0x783004FF); // CLOCK ENABLE00
	Sccb_Write(0x783006C3); // CLOCK ENABLE02
	Sccb_Write(0x78300E45); // MIPI CONTROL 00
	//Sccb_Write(0x78300E18); // MIPI CONTROL 00
	Sccb_Write(0x78302E08); // SYSTEM CONTROL
	Sccb_Write(0x7843003F); // FORMAT CONTROL00(UYVY)
	Sccb_Write(0x78501F00); // FORMAT MUX CONTROL
	Sccb_Write(0x78471303); // JPG MODE SELECT
	Sccb_Write(0x78440704); // JPEG CTRL07
	Sccb_Write(0x78440E00); // DEBUG MODE
	Sccb_Write(0x78460B35); // DEBUG MODE
	Sccb_Write(0x78460C22); // VFIFO CTRL0C
	Sccb_Write(0x7848370A); // PCLK PERIOD
	Sccb_Write(0x78480004); // MIPI CTRL 00
	Sccb_Write(0x78382402); // INVALID ADDRESS (vsync stop)
	*/
	Sccb_Write(0x785000A7); // ISP CONTROL 00 // この２つで画質が治った
	Sccb_Write(0x785001A3); // ISP CONTROL 01

	Sccb_Write(0x785180FF); // AWB CONTROL 00
	Sccb_Write(0x785181F2); // AWB CONTROL 01
	Sccb_Write(0x78518200); // AWB CONTROL 02
	Sccb_Write(0x78518314); // AWB CONTROL 03
	Sccb_Write(0x78518425); // AWB CONTROL 04
	Sccb_Write(0x78518524); // AWB CONTROL 05
	Sccb_Write(0x78518609); // AWB CONTROL
	Sccb_Write(0x78518709); // AWB CONTROL
	Sccb_Write(0x78518809); // AWB CONTROL
	Sccb_Write(0x78518988); // AWB CONTROL
	Sccb_Write(0x78518A54); // AWB CONTROL
	Sccb_Write(0x78518BEE); // AWB CONTROL
	Sccb_Write(0x78518CB2); // AWB CONTROL
	Sccb_Write(0x78518D50); // AWB CONTROL
	Sccb_Write(0x78518E34); // AWB CONTROL
	Sccb_Write(0x78518F6B); // AWB CONTROL
	Sccb_Write(0x78519046); // AWB CONTROL
	Sccb_Write(0x785191F8); // AWB CONTROL 17
	Sccb_Write(0x78519204); // AWB CONTROL 18
	Sccb_Write(0x78519370); // AWB CONTROL 19
	Sccb_Write(0x785194F0); // AWB CONTROL 20
	Sccb_Write(0x785195F0); // AWB CONTROL 21
	Sccb_Write(0x78519603); // AWB CONTROL 22
	Sccb_Write(0x78519701); // AWB CONTROL 23
	Sccb_Write(0x78519804); // DEBUG MODE
	Sccb_Write(0x7851996C); // DEBUG MODE
	Sccb_Write(0x78519A04); // DEBUG MODE
	Sccb_Write(0x78519B00); // DEBUG MODE
	Sccb_Write(0x78519C09); // DEBUG MODE
	Sccb_Write(0x78519D2B); // DEBUG MODE
	Sccb_Write(0x78519E38); // AWB CONTROL 30
	Sccb_Write(0x7853811E); // CMX1
	Sccb_Write(0x7853825B); // CMX2
	Sccb_Write(0x78538308); // CMX3
	Sccb_Write(0x7853840A); // CMX4
	Sccb_Write(0x7853857E); // CMX5
	Sccb_Write(0x78538688); // CMX6
	Sccb_Write(0x7853877C); // CMX7
	Sccb_Write(0x7853886C); // CMX8
	Sccb_Write(0x78538910); // DMX9
	Sccb_Write(0x78538A01); // CMXSIGN
	Sccb_Write(0x78538B98); // CMXSIGN
	Sccb_Write(0x78530008); // CIP SHARPENMT THRESHOLD 1
	Sccb_Write(0x78530130); // CIP SHARPENMT THRESHOLD 2
	Sccb_Write(0x78530210); // CIP SHARPENMT OFFSET1
	Sccb_Write(0x78530300); // CIP SHARPENMT OFFSET2
	Sccb_Write(0x78530408); // CIP DNS THRESHOLD 1
	Sccb_Write(0x78530530); // CIP DNS THRESHOLD 2
	Sccb_Write(0x78530608); // CIP DNS OFFSET1
	Sccb_Write(0x78530716); // CIP DNS OFFSET2
	Sccb_Write(0x78530908); // CIP SHARPENTH THRESHOLD 1
	Sccb_Write(0x78530A30); // CIP SHARPENTH THRESHOLD 2
	Sccb_Write(0x78530B04); // CIP SHARPENTH OFFSET 1
	Sccb_Write(0x78530C06); // CIP SHARPENTH OFFSET 2
	Sccb_Write(0x78548001); // GAMMA CONTROL00
	Sccb_Write(0x78548108); // GAMMA YST00
	Sccb_Write(0x78548214); // GAMMA YST01
	Sccb_Write(0x78548328); // GAMMA YST02
	Sccb_Write(0x78548451); // GAMMA YST03
	Sccb_Write(0x78548565); // GAMMA YST04
	Sccb_Write(0x78548671); // GAMMA YST05
	Sccb_Write(0x7854877D); // GAMMA YST06
	Sccb_Write(0x78548887); // GAMMA YST07
	Sccb_Write(0x78548991); // GAMMA YST08
	Sccb_Write(0x78548A9A); // GAMMA YST09
	Sccb_Write(0x78548BAA); // GAMMA YST0A
	Sccb_Write(0x78548CB8); // GAMMA YST0B
	Sccb_Write(0x78548DCD); // GAMMA YST0C
	Sccb_Write(0x78548EDD); // GAMMA YST0D
	Sccb_Write(0x78548FEA); // GAMMA YST0E
	Sccb_Write(0x7854901D); // GAMMA YST0F
	Sccb_Write(0x78558002); // SDE CTRL0
	Sccb_Write(0x78558340); // SDE CTRL3
	Sccb_Write(0x78558410); // SDE CTRL4
	Sccb_Write(0x78558910); // SDE CTRL9
	Sccb_Write(0x78558A00); // SDE CTRL10
	Sccb_Write(0x78558BF8); // SDE CTRL11
	Sccb_Write(0x78580023); // GMTRX00
	Sccb_Write(0x78580114); // GMTRX01
	Sccb_Write(0x7858020F); // GMTRX02
	Sccb_Write(0x7858030F); // GMTRX03
	Sccb_Write(0x78580412); // GMTRX04
	Sccb_Write(0x78580526); // GMTRX05
	Sccb_Write(0x7858060C); // GMTRX10
	Sccb_Write(0x78580708); // GMTRX11
	Sccb_Write(0x78580805); // GMTRX12
	Sccb_Write(0x78580905); // GMTRX13
	Sccb_Write(0x78580A08); // GMTRX14
	Sccb_Write(0x78580B0D); // GMTRX15
	Sccb_Write(0x78580C08); // GMTRX20
	Sccb_Write(0x78580D03); // GMTRX21
	Sccb_Write(0x78580E00); // GMTRX22
	Sccb_Write(0x78580F00); // GMTRX23
	Sccb_Write(0x78581003); // GMTRX24
	Sccb_Write(0x78581109); // GMTRX25
	Sccb_Write(0x78581207); // GMTRX30
	Sccb_Write(0x78581303); // GMTRX31
	Sccb_Write(0x78581400); // GMTRX32
	Sccb_Write(0x78581501); // GMTRX33
	Sccb_Write(0x78581603); // GMTRX34
	Sccb_Write(0x78581708); // GMTRX35
	Sccb_Write(0x7858180D); // GMTRX40
	Sccb_Write(0x78581908); // GMTRX41
	Sccb_Write(0x78581A05); // GMTRX42
	Sccb_Write(0x78581B06); // GMTRX43
	Sccb_Write(0x78581C08); // GMTRX44
	Sccb_Write(0x78581D0E); // GMTRX45
	Sccb_Write(0x78581E29); // GMTRX50
	Sccb_Write(0x78581F17); // GMTRX51
	Sccb_Write(0x78582011); // GMTRX52
	Sccb_Write(0x78582111); // GMTRX53
	Sccb_Write(0x78582215); // GMTRX54
	Sccb_Write(0x78582328); // GMTRX55
	Sccb_Write(0x78582446); // BRMATRX00
	Sccb_Write(0x78582526); // BRMATRX01
	Sccb_Write(0x78582608); // BRMATRX02
	Sccb_Write(0x78582726); // BRMATRX03
	Sccb_Write(0x78582864); // BRMATRX04
	Sccb_Write(0x78582926); // BRMATRX05
	Sccb_Write(0x78582A24); // BRMATRX06
	Sccb_Write(0x78582B22); // BRMATRX07
	Sccb_Write(0x78582C24); // BRMATRX08
	Sccb_Write(0x78582D24); // BRMATRX09
	Sccb_Write(0x78582E06); // BRMATRX20
	Sccb_Write(0x78582F22); // BRMATRX21
	Sccb_Write(0x78583040); // BRMATRX22
	Sccb_Write(0x78583142); // BRMATRX23
	Sccb_Write(0x78583224); // BRMATRX24
	Sccb_Write(0x78583326); // BRMATRX30
	Sccb_Write(0x78583424); // BRMATRX31
	Sccb_Write(0x78583522); // BRMATRX32
	Sccb_Write(0x78583622); // BRMATRX33
	Sccb_Write(0x78583726); // BRMATRX34
	Sccb_Write(0x78583844); // BRMATRX40
	Sccb_Write(0x78583924); // BRMATRX41
	Sccb_Write(0x78583A26); // BRMATRX42
	Sccb_Write(0x78583B28); // BRMATRX43
	Sccb_Write(0x78583C42); // BRMATRX44
	Sccb_Write(0x78583DCE); // LENC BR OFFSET
	Sccb_Write(0x78502500); // DEBUG MODE
	Sccb_Write(0x783A0F30); // AEC CTRL0F
	Sccb_Write(0x783A1028); // AEC CTRL10
	Sccb_Write(0x783A1B30); // AEC CTRL1B
	Sccb_Write(0x783A1E26); // AEC CTRL1E
	Sccb_Write(0x783A1160); // AEC CTRL11
	Sccb_Write(0x783A1F14); // AEC CTRL1F
	Sccb_Write(0x78300802); // SYSTEM CTROL0
	Sccb_Write(0x783C0004); // 5060HZ CTRL00
	/*
	// Init_OV5640_VGA_15fps
	int rate = 0;
	// PLL Settings 1
	Sccb_Write(0x78303521); // SC PLL CONTRL1 (do not change MIPI clock)
	Sccb_Write(0x78303638); // SC PLL CONTRL2

	if (rate == 1) {
		// PLL Settings 2 (24MHz)
		Sccb_Write(0x78303511); // SC PLL CONTRL1, System clock divider 2->1
		Sccb_Write(0x78303703); // SC PLL CONTRL3, added, PLL root divider 1->0
	} else {
		// default (7MHz)
	}
	}
	*/
	Sccb_Write(0x783C0708); // LIGHT METER1 THRESHOLD
	Sccb_Write(0x783C091C); // LIGHT METER2 THRESHOLD
	Sccb_Write(0x783C0A9C); // SAMPLE NUMBER
	Sccb_Write(0x783C0B40); // SAMPLE NUMBER
	/*
	// Modified (2019.06.28)
	Sccb_Write(0x78382047); // TIMING TC REG20 + vflip
	Sccb_Write(0x78382101); // TIMING TC REG21 + No mirror
	*/
	Sccb_Write(0x78381431); // TIMING X INC
	Sccb_Write(0x78381531); // TIMING Y INC
	Sccb_Write(0x78380000); // TIMING HS
	Sccb_Write(0x78380100); // TIMING HS
	Sccb_Write(0x78380200); // TIMING VS
	Sccb_Write(0x78380304); // TIMING VS
	Sccb_Write(0x7838040A); // TIMING HW
	Sccb_Write(0x7838053F); // TIMING HW
	Sccb_Write(0x78380607); // TIMING VH
	Sccb_Write(0x7838079B); // TIMING VH

	// Added
	Sccb_Write(0x78380802); // DVPHO 640
	Sccb_Write(0x78380980);
	Sccb_Write(0x78380A01); // DVPHV 480
	Sccb_Write(0x78380BE0);

	Sccb_Write(0x78381000); // TIMING HOFFSET
	Sccb_Write(0x78381110); // TIMING HOFFSET
	Sccb_Write(0x78381200); // TIMING VOFFSET
	Sccb_Write(0x78381306); // TIMING VOFFSET

	Sccb_Write(0x78361800); // INVALID ADDRESS
	Sccb_Write(0x78361229); // INVALID ADDRESS
	Sccb_Write(0x78370864); // INVALID ADDRESS
	Sccb_Write(0x78370952); // INVALID ADDRESS
	Sccb_Write(0x78370C03); // INVALID ADDRESS
	Sccb_Write(0x783A0203); // AEC MAX EXPO(60HZ)
	Sccb_Write(0x783A03D8); // AEC MAX EXPO(60HZ)
	Sccb_Write(0x783A0801); // AEC B50 STEP
	Sccb_Write(0x783A0927); // AEC B50 STEP
	Sccb_Write(0x783A0A00); // AEC B60 STEP
	Sccb_Write(0x783A0BF6); // AEC B60 STEP
	Sccb_Write(0x783A0E03); // AEC CTRL0E
	Sccb_Write(0x783A0D04); // AEC CTRL0D
	Sccb_Write(0x783A1403); // AEC MAX EXPO(50HZ)
	Sccb_Write(0x783A15D8); // AEC MAX EXPO(50HZ)
	Sccb_Write(0x78400102); // BLC CTRL01
	Sccb_Write(0x78400402); // BLC CTRL04
	Sccb_Write(0x78471303); // JPG MODE SELECT
	Sccb_Write(0x78440704); // JPEG CTRL07
	Sccb_Write(0x78460B35); // DEBUG MODE
	Sccb_Write(0x78460C22); // VFIFO CTRL0C
	Sccb_Write(0x78382402); // INVALID ADDRESS

	//Sccb_Write(0x785001A3); // ISP CONTROL 01

	return 0;
}

void Ov5640_I2cWrite (unsigned int reg_addr, unsigned char reg_value) {
	unsigned char tmp[3];
	tmp[0] = ((reg_addr >> 8) & 0xFF); // register address high byte
	tmp[1] =  (reg_addr       & 0xFF); // low byte
	tmp[2] = reg_value;

	I2c_Write(OV5640_I2C_ADDR, tmp, 3);
}

// バーストライト用のI2cWriteの変種
// 送信データにはスレーブアドレス２バイトが含まれることに注意
void Ov5640_I2cBurstWrite (unsigned int reg_addr, unsigned char* reg_value, int total_len) {
	int available;
	int payload_len;
	unsigned char txbuf[I2C_FIFO_DEPTH]; // max FIFO length

	int remain = total_len;
	int data_index = 0;
	unsigned int reg_addr_incr = reg_addr;
	while (remain > 0) {
		// available space in tx FIFO
		available = I2c_GetFifoLength() - 2; // minus 2 byte for register address
		if (available < 0) {
			// not enough space in tx FIFO
		}

		// actual data payload size
		if (remain <= available) {
			payload_len = remain;
		} else {
			payload_len = available;
		}

		// set register address
		txbuf[0] = ((reg_addr_incr >> 8) & 0xFF); // register address high byte
		txbuf[1] =  (reg_addr_incr       & 0xFF); // low byte

		// set data in tx buffer
		for (int i = 0; i < payload_len; i++) {
			txbuf[i + 2] = reg_value[data_index];
			data_index++;
		}

		// transfer
		I2c_Write(OV5640_I2C_ADDR, txbuf, payload_len + 2);

		// for the next loop
		remain -= payload_len;
		reg_addr_incr += payload_len;
	}
}

//=============================================================================
//! OV5640 Initialize Registers
//-----------------------------------------------------------------------------
//! @param test_mode	OV5640_TEST_NORMAL: normal operation,
//!            			OV5640_TEST_COLORBAR: color bar
//-----------------------------------------------------------------------------
//! @brief This function contains register settings common to all resolution
//! modes.
//-----------------------------------------------------------------------------
//! @note Channel must be set properly in I2C expander (TCA9548A).
//=============================================================================
void Ov5640_RegisterInit (int test_mode) {

	//------------------------------------------------------------------
	// System and IO Pad Control [0x3000 - 0x3052]
	//------------------------------------------------------------------
	// SYSTEM CONTROL
	// no document, doesn't work if removed
	Ov5640_I2cWrite(0x302E, 0x08);

	// SC PLL CONTROL0
	// [7  ] Debug mode
	// [6:4] PLL charge pump control
	// [3:0] MIPI bit mode
	Ov5640_I2cWrite(0x3034, 0x18); // MIPI 8-bit mode

	// SC PLLS CTRL3
	// [7:6] Debug mode
	// [5:4] PLLS pre-divider
	// [3  ] Debug mode
	// [2  ] PLLS root divider
	// [1:0] PLLS seld5
	Ov5640_I2cWrite(0x303D, 0x10);

	// MIPI CONTROL 00
	// [7:5] mipi_lane_mode
	// [4  ] MIPI TX PHY power down
	// [3  ] MIPI RX PHY power down
	// [2  ] mipi_en
	// [1:0] Debug mode
	// setting 3'b010 to bit[7:5] will set mipi 2-lane mode
	// it differs from the datasheet
	Ov5640_I2cWrite(0x300E, 0x45); // MIPI enable, MIPI 2-lane mode

	//------------------------------------------------------------------
	// SCCB Control [0x3100 - 0x3108]
	//------------------------------------------------------------------
	// SCCB SYSTEM CTRL1
	// [7:2] Debug mode
	// [1  ] Select system input clock
	// [0  ] Debug mode
	Ov5640_I2cWrite(0x3103, 0x03);

	// SYSTEM ROOT DIVIDER
	// [7:6] Debug mode
	// [5:4] PCLK root divider
	// [3:2] sclk2x root divider
	// [1:0] SCLK root divider
	Ov5640_I2cWrite(0x3108, 0x11);

	//------------------------------------------------------------------
	// AWB Gain Control [0x3400 - 0x3406]
	//------------------------------------------------------------------
	// AWB MANUAL CONTROL
	// [7:1] Debug mode
	// [0]   AWB gain manual enable
	Ov5640_I2cWrite(0x3406, 0x00); // AWB auto mode

	//------------------------------------------------------------------
	// Timing Control [0x3800 - 0x3821]
	//------------------------------------------------------------------
	// TIMING TC REG21
	// [7:6] Debug mode
	// [5  ] JPEG enable
	// [4:3] Debug mode
	// [2  ] ISP mirror
	// [1  ] Sensor mirror
	// [0  ] Horizontal binning enable
	Ov5640_I2cWrite(0x3821, 0x06); // ISP mirror, Sensor mirror

	//------------------------------------------------------------------
	// Format Control [0x4300 - 0x430D]
	//------------------------------------------------------------------
	// FORMAT CONTROL 00
	// [7:4] Output format of formatter module
	// [3:0] Output sequence
	Ov5640_I2cWrite(0x4300, 0x30); // YUV422, YUYV...

	//------------------------------------------------------------------
	// MIPI control [0x4800 - 0x4837]
	//------------------------------------------------------------------
	// MIPI CTRL 00
	// [7:6] Debug mode
	// [5  ] Clock lane gate enable
	// [4  ] Line sync enable
	// [3  ] Lane select
	// [2  ] Idle status
	// [1:0] Debug mode
	Ov5640_I2cWrite(0x4800, 0x04); // free running, no short packet, lane1 default, LP11

	// PCLK PERIOD
	// not sure how to calculate this value.
	// values between 7 to 22 seems working.
	Ov5640_I2cWrite(0x4837, 18); // PCLK = 111MHz (18 * 0.5  = 9.0ns)

	//------------------------------------------------------------------
	// ISP Top Control [0x5000 - 0x5063]
	//------------------------------------------------------------------
	// ISP CONTROL 00
	// [7  ] LENC correction enable
	// [6  ] Debug mode
	// [5  ] RAW GMA enable
	// [4:3] Debug mode
	// [2  ] Black pixel cancellation enable
	// [1  ] Whtie pixel cancellation enable
	// [0  ] Color interpolation enable
	Ov5640_I2cWrite(0x5000, 0xD7); // B/W pixel cancellation enable, Color interpolation enable

	// ISP CONTROL 01
	// [7  ] Special digital effect enable
	// [6  ] Debug mode
	// [5  ] Scale enable
	// [4:3] Debug mode
	// [2  ] UV average enable
	// [1  ] Color matrix enable
	// [0  ] Auto white balance enable
	Ov5640_I2cWrite(0x5001, 0x03); // Color matrix enable, Auto white balance enable

	// FORMAT MUX CONTROL
	// [7:4] Debug mode
	// [3  ] Fmt vfirst
	// [2:0] Format select
	// Format MUX Control
	Ov5640_I2cWrite(0x501F, 0x00); // ISP YUV422

	// PRE ISP TEST SETTING 1
	// [7  ] Pre ISP enable
	// [6  ] Rolling
	// [5  ] Transparent
	// [4  ] Square BW
	// [3:2] Pre ISP bar style
	// [1:0] Test select
	switch (test_mode) {
	case OV5640_TEST_COLORBAR:
		Ov5640_I2cWrite(0x503D, 0x80);
		break;
	default:
		Ov5640_I2cWrite(0x503D, 0x00); // test disable (default)
		break;
	}

	// Unknown settings
	// removing these settings results in strange saturation
	Ov5640_I2cWrite(0x3618, 0x00);
	Ov5640_I2cWrite(0x3612, 0x29);
	Ov5640_I2cWrite(0x3708, 0x64);
	Ov5640_I2cWrite(0x3709, 0x52);
	Ov5640_I2cWrite(0x370C, 0x03);
};

//=============================================================================
//! OV5640 Set Image Format
//-----------------------------------------------------------------------------
//! @param resolution	Resolution mode chosen from OV5640_RESOLUTION
//! @param fps			Target FPS value
//-----------------------------------------------------------------------------
//! @brief This function contains register settings which depends of the
//! resolution and FPS.
//-----------------------------------------------------------------------------
//! @note Channel must be set properly in I2C expander (TCA9548A).
//! @note Only resolution 640x480 is tested.
//=============================================================================
void Ov5640_Format (int resolution, double fps) {

	//------------------------------------------------------------------
	// System and IO Pad Control [0x3000 - 0x3052]
	//------------------------------------------------------------------
	// SC PLL CONTRL1
	// [7:4] System clock divider
	// [3:0] Scale divider for MIPI
	Ov5640_I2cWrite(0x3035, 0x21);

	// SC PLL CONTRL2
	// [7:0] PLL multiplier
	// this formula is derived experimentally and only available for 640x480
	double tmpd = (70.0 / 75.0) * fps;
	unsigned char tmpc = (unsigned char)tmpd;
	Ov5640_I2cWrite(0x3036, tmpc);

	// SC PLL CONTRL3
	// [7:5] Debug mode
	// [4  ] PLL root divider
	// [3:0] PLL pre-divider
	Ov5640_I2cWrite(0x3037, 0x05);

	//------------------------------------------------------------------
	// Timing Control [0x3800 - 0x3821]
	//------------------------------------------------------------------
	int x_addr_stt, x_addr_end;
	int y_addr_stt, y_addr_end;
	int output_width;
	int output_height;
	int total_h_size;
	int total_v_size;

	// not tested except 640x480
	switch (resolution) {
	case OV5640_RESOLUTION_640_480:
		x_addr_stt    =    0;
		x_addr_end    = 2623;
		y_addr_stt    =    4;
		y_addr_end    = 1947;
		output_width  =  640;
		output_height =  480;
		total_h_size  = 1896;
		total_v_size  =  984;
		break;
	case OV5640_RESOLUTION_1920_1080:
		output_width  = 1920;
		output_height = 1080;
		break;
	case OV5640_RESOLUTION_1280_720:
		output_width  = 1280;
		output_height =  720;
		break;
	case OV5640_RESOLUTION_960_540:
		output_width  =  960;
		output_height =  540;
		break;
	case OV5640_RESOLUTION_640_360:
		output_width  =  640;
		output_height =  360;
		break;
	case OV5640_RESOLUTION_320_240:
		output_width  =  320;
		output_height =  240;
		break;
	case OV5640_RESOLUTION_320_200:
		output_width  =  320;
		output_height =  200;
		break;
	default:
		x_addr_stt    =    0;
		x_addr_end    = 2623;
		y_addr_stt    =    4;
		y_addr_end    = 1947;
		output_width  =  640;
		output_height =  480;
		total_h_size  = 1896;
		total_v_size  =  984;
		break;
	}

	// X/Y Start Address
	Ov5640_I2cWrite(0x3800, (x_addr_stt >> 8) & 0x0F);
	Ov5640_I2cWrite(0x3801,  x_addr_stt       & 0xFF);
	Ov5640_I2cWrite(0x3802, (y_addr_stt >> 8) & 0x0F);
	Ov5640_I2cWrite(0x3803,  y_addr_stt       & 0xFF);

	// X/Y End Address
	Ov5640_I2cWrite(0x3804, (x_addr_end >> 8) & 0x0F);
	Ov5640_I2cWrite(0x3805,  x_addr_end       & 0xFF);
	Ov5640_I2cWrite(0x3806, (y_addr_end >> 8) & 0x0F);
	Ov5640_I2cWrite(0x3807,  y_addr_end       & 0xFF);

	// Output Width/Height
	Ov5640_I2cWrite(0x3808, (output_width >> 8) & 0x0F);
	Ov5640_I2cWrite(0x3809,  output_width       & 0xFF);
	Ov5640_I2cWrite(0x380A, (output_height >> 8) & 0x07);
	Ov5640_I2cWrite(0x380B,  output_height       & 0xFF);

	// Total H/V Size
	Ov5640_I2cWrite(0x380C, (total_h_size >> 8) & 0x1F);
	Ov5640_I2cWrite(0x380D,  total_h_size       & 0xFF);
	Ov5640_I2cWrite(0x380E, (total_v_size >> 8) & 0xFF);
	Ov5640_I2cWrite(0x380F,  total_v_size       & 0xFF);

	// TIMING X INC
	// [7:4] Horizontal odd subsample increment
	// [3:0] Horizontal even subsample increment
	Ov5640_I2cWrite(0x3814, 0x62);

	// TIMING Y INC
	// [7:4] Vertical odd subsample increment
	// [3:0] Vertical even subsample increment
	Ov5640_I2cWrite(0x3815, 0x62);
};

//=============================================================================
//! OV5640 Initialize
//-----------------------------------------------------------------------------
//! @param test_mode	OV5640_TEST_NORMAL: normal operation,
//!            			OV5640_TEST_COLORBAR: color bar
//! @param resolution	Resolution mode chosen from OV5640_RESOLUTION
//! @param fps			Target FPS value
//-----------------------------------------------------------------------------
//! @brief Top level function regarding to initialization of OV5640.
//-----------------------------------------------------------------------------
//! @note Channel must be set properly in I2C expander (TCA9548A).
//=============================================================================
int Ov5640_Init(int test_mode, int resolution, double fps)
{
	Ov5640_PowerMode(OV5640_POWER_DOWN);

	// common register settings
	Ov5640_RegisterInit(test_mode);

	// format dependant settings
	Ov5640_Format(resolution, fps);

	// added
	Ov5640_Init2();

	Ov5640_PowerMode(OV5640_POWER_UP);

	return 0;
}

void Ov5640_PowerUp(void) {
	unsigned char reg_value;

	Ov5640_I2cWrite(0x3103, 0x11);		// SCCB SYSTEM CTRL1
	Ov5640_I2cWrite(0x3008, 0x82);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3008, 0x42);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3103, 0x03);		// SCCB SYSTEM CTRL1
	Ov5640_I2cWrite(0x3017, 0x00);		// PAD OUTPUT ENABLE 01
	Ov5640_I2cWrite(0x3018, 0x00);		// PAD OUTPUT ENABLE 02
	Ov5640_I2cWrite(0x3034, 0x18);		// SC PLL CONTRL0
	Ov5640_I2cWrite(0x3035, 0x12);		// SC PLL CONTRL1
	Ov5640_I2cWrite(0x3036, 0x38);		// SC PLL CONTRL2
	Ov5640_I2cWrite(0x3037, 0x13);		// SC PLL CONTRL3
	Ov5640_I2cWrite(0x3108, 0x01);		// SYSTEM ROOT DIVIDER
	Ov5640_I2cWrite(0x3630, 0x36);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3631, 0x0E);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3632, 0xE2);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3633, 0x12);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3621, 0xE0);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3704, 0xA0);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3703, 0x5A);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3715, 0x78);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3717, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x370B, 0x60);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3705, 0x1A);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3905, 0x02);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3906, 0x10);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3901, 0x0A);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3731, 0x12);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3600, 0x08);		// DEBUG MODE
	Ov5640_I2cWrite(0x3601, 0x33);		// DEBUG MODE
	Ov5640_I2cWrite(0x302D, 0x60);		// SYSTEM CONTROL
	Ov5640_I2cWrite(0x3620, 0x52);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x371B, 0x20);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x471C, 0x50);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3A13, 0x43);		// AEC CTRL13
	Ov5640_I2cWrite(0x3A18, 0x00);		// AEC GAIN CEILING
	Ov5640_I2cWrite(0x3A19, 0xF8);		// AEC GAIN CEILING
	Ov5640_I2cWrite(0x3635, 0x13);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3636, 0x03);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3634, 0x40);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3622, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3C01, 0x34);		// 5060HZ CTRL01
	Ov5640_I2cWrite(0x3C04, 0x28);		// 5060HZ CTRL04
	Ov5640_I2cWrite(0x3C05, 0x98);		// 5060HZ CTRL05
	Ov5640_I2cWrite(0x3C06, 0x00);		// LIGHT METER1 THRESHOLD
	Ov5640_I2cWrite(0x3C07, 0x08);		// LIGHT METER1 THRESHOLD
	Ov5640_I2cWrite(0x3C08, 0x00);		// LIGHT METER2 THRESHOLD
	Ov5640_I2cWrite(0x3C09, 0x1C);		// LIGHT METER2 THRESHOLD
	Ov5640_I2cWrite(0x3C0A, 0x9C);		// SAMPLE NUMBER
	Ov5640_I2cWrite(0x3C0B, 0x40);		// SAMPLE NUMBER
	Ov5640_I2cWrite(0x3820, 0x41);		// TIMING TC REG20
	Ov5640_I2cWrite(0x3821, 0x07);		// TIMING TC REG21
	Ov5640_I2cWrite(0x3814, 0x31);		// TIMING X INC
	Ov5640_I2cWrite(0x3815, 0x31);		// TIMING Y INC
	Ov5640_I2cWrite(0x3800, 0x00);		// TIMING HS
	Ov5640_I2cWrite(0x3801, 0x00);		// TIMING HS
	Ov5640_I2cWrite(0x3802, 0x00);		// TIMING VS
	Ov5640_I2cWrite(0x3803, 0x04);		// TIMING VS
	Ov5640_I2cWrite(0x3804, 0x0A);		// TIMING HW
	Ov5640_I2cWrite(0x3805, 0x3F);		// TIMING HW
	Ov5640_I2cWrite(0x3806, 0x07);		// TIMING VH
	Ov5640_I2cWrite(0x3807, 0x9B);		// TIMING VH
	Ov5640_I2cWrite(0x3808, 0x02);		// TIMING DVPHO
	Ov5640_I2cWrite(0x3809, 0x80);		// TIMING DVPHO
	Ov5640_I2cWrite(0x380A, 0x01);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380B, 0xE0);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380C, 0x07);		// TIMING HTS
	Ov5640_I2cWrite(0x380D, 0x68);		// TIMING HTS
	Ov5640_I2cWrite(0x380E, 0x03);		// TIMING VTS
	Ov5640_I2cWrite(0x380F, 0xD8);		// TIMING VTS
	Ov5640_I2cWrite(0x3810, 0x00);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3811, 0x10);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3812, 0x00);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3813, 0x06);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3618, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3612, 0x29);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3708, 0x64);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3709, 0x52);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x370C, 0x03);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3A02, 0x03);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A03, 0xD8);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A08, 0x01);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A09, 0x27);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A0A, 0x00);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0B, 0xF6);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0E, 0x03);		// AEC CTRL0E
	Ov5640_I2cWrite(0x3A0D, 0x04);		// AEC CTRL0D
	Ov5640_I2cWrite(0x3A14, 0x03);		// AEC MAX EXPO(50HZ)
	Ov5640_I2cWrite(0x3A15, 0xD8);		// AEC MAX EXPO(50HZ)
	Ov5640_I2cWrite(0x4001, 0x02);		// BLC CTRL01
	Ov5640_I2cWrite(0x4004, 0x02);		// BLC CTRL04
	Ov5640_I2cWrite(0x3000, 0x00);		// SYSTEM_RESET00
	Ov5640_I2cWrite(0x3002, 0x1C);		// SYSTEM RESET02
	Ov5640_I2cWrite(0x3004, 0xFF);		// CLOCK ENABLE00
	Ov5640_I2cWrite(0x3006, 0xC3);		// CLOCK ENABLE02
	Ov5640_I2cWrite(0x300E, 0x25);		// MIPI CONTROL 00
	Ov5640_I2cWrite(0x302E, 0x08);		// SYSTEM CONTROL
	Ov5640_I2cWrite(0x4300, 0x30);		// FORMAT CONTROL00
	Ov5640_I2cWrite(0x501F, 0x00);		// FORMAT MUX CONTROL
	Ov5640_I2cWrite(0x4713, 0x03);		// JPG MODE SELECT
	Ov5640_I2cWrite(0x4407, 0x04);		// JPEG CTRL07
	Ov5640_I2cWrite(0x440E, 0x00);		// DEBUG MODE
	Ov5640_I2cWrite(0x460B, 0x35);		// DEBUG MODE
	Ov5640_I2cWrite(0x460C, 0x22);		// VFIFO CTRL0C
	Ov5640_I2cWrite(0x3824, 0x02);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x5000, 0xA7);		// ISP CONTROL 00
	Ov5640_I2cWrite(0x5001, 0xA3);		// ISP CONTROL 01
	Ov5640_I2cWrite(0x5180, 0xFF);		// AWB CONTROL 00
	Ov5640_I2cWrite(0x5181, 0xF2);		// AWB CONTROL 01
	Ov5640_I2cWrite(0x5182, 0x00);		// AWB CONTROL 02
	Ov5640_I2cWrite(0x5183, 0x14);		// AWB CONTROL 03
	Ov5640_I2cWrite(0x5184, 0x25);		// AWB CONTROL 04
	Ov5640_I2cWrite(0x5185, 0x24);		// AWB CONTROL 05
	Ov5640_I2cWrite(0x5186, 0x09);		// AWB CONTROL
	Ov5640_I2cWrite(0x5187, 0x09);		// AWB CONTROL
	Ov5640_I2cWrite(0x5188, 0x09);		// AWB CONTROL
	Ov5640_I2cWrite(0x5189, 0x75);		// AWB CONTROL
	Ov5640_I2cWrite(0x518A, 0x54);		// AWB CONTROL
	Ov5640_I2cWrite(0x518B, 0xE0);		// AWB CONTROL
	Ov5640_I2cWrite(0x518C, 0xB2);		// AWB CONTROL
	Ov5640_I2cWrite(0x518D, 0x42);		// AWB CONTROL
	Ov5640_I2cWrite(0x518E, 0x3D);		// AWB CONTROL
	Ov5640_I2cWrite(0x518F, 0x56);		// AWB CONTROL
	Ov5640_I2cWrite(0x5190, 0x46);		// AWB CONTROL
	Ov5640_I2cWrite(0x5191, 0xF8);		// AWB CONTROL 17
	Ov5640_I2cWrite(0x5192, 0x04);		// AWB CONTROL 18
	Ov5640_I2cWrite(0x5193, 0x70);		// AWB CONTROL 19
	Ov5640_I2cWrite(0x5194, 0xF0);		// AWB CONTROL 20
	Ov5640_I2cWrite(0x5195, 0xF0);		// AWB CONTROL 21
	Ov5640_I2cWrite(0x5196, 0x03);		// AWB CONTROL 22
	Ov5640_I2cWrite(0x5197, 0x01);		// AWB CONTROL 23
	Ov5640_I2cWrite(0x5198, 0x04);		// DEBUG MODE
	Ov5640_I2cWrite(0x5199, 0x12);		// DEBUG MODE
	Ov5640_I2cWrite(0x519A, 0x04);		// DEBUG MODE
	Ov5640_I2cWrite(0x519B, 0x00);		// DEBUG MODE
	Ov5640_I2cWrite(0x519C, 0x06);		// DEBUG MODE
	Ov5640_I2cWrite(0x519D, 0x82);		// DEBUG MODE
	Ov5640_I2cWrite(0x519E, 0x38);		// AWB CONTROL 30
	Ov5640_I2cWrite(0x5381, 0x1E);		// CMX1
	Ov5640_I2cWrite(0x5382, 0x5B);		// CMX2
	Ov5640_I2cWrite(0x5383, 0x08);		// CMX3
	Ov5640_I2cWrite(0x5384, 0x0A);		// CMX4
	Ov5640_I2cWrite(0x5385, 0x7E);		// CMX5
	Ov5640_I2cWrite(0x5386, 0x88);		// CMX6
	Ov5640_I2cWrite(0x5387, 0x7C);		// CMX7
	Ov5640_I2cWrite(0x5388, 0x6C);		// CMX8
	Ov5640_I2cWrite(0x5389, 0x10);		// DMX9
	Ov5640_I2cWrite(0x538A, 0x01);		// CMXSIGN
	Ov5640_I2cWrite(0x538B, 0x98);		// CMXSIGN
	Ov5640_I2cWrite(0x5300, 0x08);		// CIP SHARPENMT THRESHOLD 1
	Ov5640_I2cWrite(0x5301, 0x30);		// CIP SHARPENMT THRESHOLD 2
	Ov5640_I2cWrite(0x5302, 0x10);		// CIP SHARPENMT OFFSET1
	Ov5640_I2cWrite(0x5303, 0x00);		// CIP SHARPENMT OFFSET2
	Ov5640_I2cWrite(0x5304, 0x08);		// CIP DNS THRESHOLD 1
	Ov5640_I2cWrite(0x5305, 0x30);		// CIP DNS THRESHOLD 2
	Ov5640_I2cWrite(0x5306, 0x08);		// CIP DNS OFFSET1
	Ov5640_I2cWrite(0x5307, 0x16);		// CIP DNS OFFSET2
	Ov5640_I2cWrite(0x5309, 0x08);		// CIP SHARPENTH THRESHOLD 1
	Ov5640_I2cWrite(0x530A, 0x30);		// CIP SHARPENTH THRESHOLD 2
	Ov5640_I2cWrite(0x530B, 0x04);		// CIP SHARPENTH OFFSET 1
	Ov5640_I2cWrite(0x530C, 0x06);		// CIP SHARPENTH OFFSET 2
	Ov5640_I2cWrite(0x5480, 0x01);		// GAMMA CONTROL00
	Ov5640_I2cWrite(0x5481, 0x08);		// GAMMA YST00
	Ov5640_I2cWrite(0x5482, 0x14);		// GAMMA YST01
	Ov5640_I2cWrite(0x5483, 0x28);		// GAMMA YST02
	Ov5640_I2cWrite(0x5484, 0x51);		// GAMMA YST03
	Ov5640_I2cWrite(0x5485, 0x65);		// GAMMA YST04
	Ov5640_I2cWrite(0x5486, 0x71);		// GAMMA YST05
	Ov5640_I2cWrite(0x5487, 0x7D);		// GAMMA YST06
	Ov5640_I2cWrite(0x5488, 0x87);		// GAMMA YST07
	Ov5640_I2cWrite(0x5489, 0x91);		// GAMMA YST08
	Ov5640_I2cWrite(0x548A, 0x9A);		// GAMMA YST09
	Ov5640_I2cWrite(0x548B, 0xAA);		// GAMMA YST0A
	Ov5640_I2cWrite(0x548C, 0xB8);		// GAMMA YST0B
	Ov5640_I2cWrite(0x548D, 0xCD);		// GAMMA YST0C
	Ov5640_I2cWrite(0x548E, 0xDD);		// GAMMA YST0D
	Ov5640_I2cWrite(0x548F, 0xEA);		// GAMMA YST0E
	Ov5640_I2cWrite(0x5490, 0x1D);		// GAMMA YST0F
	Ov5640_I2cWrite(0x5580, 0x02);		// SDE CTRL0
	Ov5640_I2cWrite(0x5583, 0x40);		// SDE CTRL3
	Ov5640_I2cWrite(0x5584, 0x10);		// SDE CTRL4
	Ov5640_I2cWrite(0x5589, 0x10);		// SDE CTRL9
	Ov5640_I2cWrite(0x558A, 0x00);		// SDE CTRL10
	Ov5640_I2cWrite(0x558B, 0xF8);		// SDE CTRL11
	Ov5640_I2cWrite(0x5800, 0x23);		// GMTRX00
	Ov5640_I2cWrite(0x5801, 0x14);		// GMTRX01
	Ov5640_I2cWrite(0x5802, 0x0F);		// GMTRX02
	Ov5640_I2cWrite(0x5803, 0x0F);		// GMTRX03
	Ov5640_I2cWrite(0x5804, 0x12);		// GMTRX04
	Ov5640_I2cWrite(0x5805, 0x26);		// GMTRX05
	Ov5640_I2cWrite(0x5806, 0x0C);		// GMTRX10
	Ov5640_I2cWrite(0x5807, 0x08);		// GMTRX11
	Ov5640_I2cWrite(0x5808, 0x05);		// GMTRX12
	Ov5640_I2cWrite(0x5809, 0x05);		// GMTRX13
	Ov5640_I2cWrite(0x580A, 0x08);		// GMTRX14
	Ov5640_I2cWrite(0x580B, 0x0D);		// GMTRX15
	Ov5640_I2cWrite(0x580C, 0x08);		// GMTRX20
	Ov5640_I2cWrite(0x580D, 0x03);		// GMTRX21
	Ov5640_I2cWrite(0x580E, 0x00);		// GMTRX22
	Ov5640_I2cWrite(0x580F, 0x00);		// GMTRX23
	Ov5640_I2cWrite(0x5810, 0x03);		// GMTRX24
	Ov5640_I2cWrite(0x5811, 0x09);		// GMTRX25
	Ov5640_I2cWrite(0x5812, 0x07);		// GMTRX30
	Ov5640_I2cWrite(0x5813, 0x03);		// GMTRX31
	Ov5640_I2cWrite(0x5814, 0x00);		// GMTRX32
	Ov5640_I2cWrite(0x5815, 0x01);		// GMTRX33
	Ov5640_I2cWrite(0x5816, 0x03);		// GMTRX34
	Ov5640_I2cWrite(0x5817, 0x08);		// GMTRX35
	Ov5640_I2cWrite(0x5818, 0x0D);		// GMTRX40
	Ov5640_I2cWrite(0x5819, 0x08);		// GMTRX41
	Ov5640_I2cWrite(0x581A, 0x05);		// GMTRX42
	Ov5640_I2cWrite(0x581B, 0x06);		// GMTRX43
	Ov5640_I2cWrite(0x581C, 0x08);		// GMTRX44
	Ov5640_I2cWrite(0x581D, 0x0E);		// GMTRX45
	Ov5640_I2cWrite(0x581E, 0x29);		// GMTRX50
	Ov5640_I2cWrite(0x581F, 0x17);		// GMTRX51
	Ov5640_I2cWrite(0x5820, 0x11);		// GMTRX52
	Ov5640_I2cWrite(0x5821, 0x11);		// GMTRX53
	Ov5640_I2cWrite(0x5822, 0x15);		// GMTRX54
	Ov5640_I2cWrite(0x5823, 0x28);		// GMTRX55
	Ov5640_I2cWrite(0x5824, 0x46);		// BRMATRX00
	Ov5640_I2cWrite(0x5825, 0x26);		// BRMATRX01
	Ov5640_I2cWrite(0x5826, 0x08);		// BRMATRX02
	Ov5640_I2cWrite(0x5827, 0x26);		// BRMATRX03
	Ov5640_I2cWrite(0x5828, 0x64);		// BRMATRX04
	Ov5640_I2cWrite(0x5829, 0x26);		// BRMATRX05
	Ov5640_I2cWrite(0x582A, 0x24);		// BRMATRX06
	Ov5640_I2cWrite(0x582B, 0x22);		// BRMATRX07
	Ov5640_I2cWrite(0x582C, 0x24);		// BRMATRX08
	Ov5640_I2cWrite(0x582D, 0x24);		// BRMATRX09
	Ov5640_I2cWrite(0x582E, 0x06);		// BRMATRX20
	Ov5640_I2cWrite(0x582F, 0x22);		// BRMATRX21
	Ov5640_I2cWrite(0x5830, 0x40);		// BRMATRX22
	Ov5640_I2cWrite(0x5831, 0x42);		// BRMATRX23
	Ov5640_I2cWrite(0x5832, 0x24);		// BRMATRX24
	Ov5640_I2cWrite(0x5833, 0x26);		// BRMATRX30
	Ov5640_I2cWrite(0x5834, 0x24);		// BRMATRX31
	Ov5640_I2cWrite(0x5835, 0x22);		// BRMATRX32
	Ov5640_I2cWrite(0x5836, 0x22);		// BRMATRX33
	Ov5640_I2cWrite(0x5837, 0x26);		// BRMATRX34
	Ov5640_I2cWrite(0x5838, 0x44);		// BRMATRX40
	Ov5640_I2cWrite(0x5839, 0x24);		// BRMATRX41
	Ov5640_I2cWrite(0x583A, 0x26);		// BRMATRX42
	Ov5640_I2cWrite(0x583B, 0x28);		// BRMATRX43
	Ov5640_I2cWrite(0x583C, 0x42);		// BRMATRX44
	Ov5640_I2cWrite(0x583D, 0xCE);		// LENC BR OFFSET
	Ov5640_I2cWrite(0x5025, 0x00);		// DEBUG MODE
	Ov5640_I2cWrite(0x3A0F, 0x30);		// AEC CTRL0F
	Ov5640_I2cWrite(0x3A10, 0x28);		// AEC CTRL10
	Ov5640_I2cWrite(0x3A1B, 0x30);		// AEC CTRL1B
	Ov5640_I2cWrite(0x3A1E, 0x26);		// AEC CTRL1E
	Ov5640_I2cWrite(0x3A11, 0x60);		// AEC CTRL11
	Ov5640_I2cWrite(0x3A1F, 0x14);		// AEC CTRL1F
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x503D, 0x00);		// PRE ISP TEST SETTING 1
	Ov5640_I2cWrite(0x3031, 0x00);		// SC PWC
	Ov5640_I2cWrite(0x0000, 0x00);		// INVALID ADDRESS
	Ov5640_I2cRead(0x4033, &reg_value);	// BLACK LEVEL11
	Ov5640_I2cWrite(0x4033, 0xD3);		// BLACK LEVEL11
	Ov5640_I2cWrite(0x3000, 0x20);		// SYSTEM_RESET00

	unsigned char tmp1[] = {
		0x02,0x0F,0x0C,0x02,0x0A,0x09,0xC2,0x01,0x22,0x22,0x00,0x02,0x0E,0xF6,0xE5,0x1F,
		0x70,0x72,0xF5,0x1E,0xD2,0x35,0xFF,0xEF,0x25,0xE0,0x24,0x4C,0xF8,0xE4,0xF6,0x08,
		0xF6,0x0F,0xBF,0x34,0xF2,0x90,0x0E,0x8C,0xE4,0x93,0xFF,0xE5,0x49,0xC3,0x9F,0x50,
		0x04,0x7F,0x05,0x80,0x02,0x7F,0xFB,0x78,0xBB,0xA6,0x07,0x12,0x0D,0xAF,0x40,0x04,
		0x7F,0x03,0x80,0x02,0x7F,0x30,0x78,0xBA,0xA6,0x07,0xE6,0x18,0xF6,0x08,0xE6,0x78,
		0xB7,0xF6,0x78,0xBA,0xE6,0x78,0xB8,0xF6,0x78,0xBD,0x76,0x33,0xE4,0x08,0xF6,0x78,
		0xB6,0x76,0x01,0x75,0x48,0x02,0x78,0xB4,0xF6,0x08,0xF6,0x74,0xFF,0x78,0xBF,0xF6,
		0x08,0xF6,0x75,0x1F,0x01,0x78,0xBA,0xE6,0x75,0xF0,0x05,0xA4,0xF5,0x49,0x12,0x0A,
		0xCF,0xC2,0x37,0x22,0x78,0xB6,0xE6,0xD3,0x94,0x00,0x40,0x02,0x16,0x22,0xE5,0x1F,
		0xB4,0x05,0x23,0xE4,0xF5,0x1F,0xC2,0x01,0x78,0xB4,0xE6,0xFE,0x08,0xE6,0xFF,0x78,
		0x4C,0xA6,0x06,0x08,0xA6,0x07,0xA2,0x37,0xE4,0x33,0xF5,0x3C,0x90,0x30,0x28,0xF0,
		0x75,0x1E,0x10,0xD2,0x35,0x22,0xE5,0x49,0x75,0xF0,0x05,0x84,0x78,0xBA,0xF6,0x90,
		0x0E,0x85,0xE4,0x93,0xFF,0x25,0xE0,0x24,0x0A,0xF8,0xE6,0xFC,0x08,0xE6,0xFD,0x78,
		0xBA,0xE6,0x25,0xE0,0x24,0x4C,0xF8,0xA6,0x04,0x08,0xA6,0x05,0xEF,0x12,0x0D,0xB6,
		0xD3,0x78,0xB5,0x96,0xEE,0x18,0x96,0x40,0x0D,0x78,0xBA,0xE6,0x78,0xB7,0xF6,0x78,
		0xB4,0xA6,0x06,0x08,0xA6,0x07,0x90,0x0E,0x85,0xE4,0x93,0x12,0x0D,0xB6,0xC3
	};
	Ov5640_I2cBurstWrite(0x8000, tmp1, 255);
	unsigned char tmp2[] = {
		0x78,0xC0,0x96,0xEE,0x18,0x96,0x50,0x0D,0x78,0xBA,0xE6,0x78,0xB8,0xF6,0x78,0xBF,
		0xA6,0x06,0x08,0xA6,0x07,0x78,0xB4,0xE6,0xFE,0x08,0xE6,0xC3,0x78,0xC0,0x96,0xFF,
		0xEE,0x18,0x96,0x78,0xC1,0xF6,0x08,0xA6,0x07,0x90,0x0E,0x8E,0xE4,0x18,0x12,0x0D,
		0x94,0x40,0x02,0xD2,0x37,0x78,0xBA,0xE6,0x08,0x26,0x08,0xF6,0xE5,0x1F,0x64,0x01,
		0x70,0x4A,0xE6,0xC3,0x78,0xBE,0x12,0x0D,0x8A,0x40,0x05,0x12,0x0D,0x85,0x40,0x39,
		0x12,0x0D,0xAD,0x40,0x04,0x7F,0xFE,0x80,0x02,0x7F,0x02,0x78,0xBB,0xA6,0x07,0x78,
		0xB7,0xE6,0x24,0x03,0x78,0xBD,0xF6,0x78,0xB7,0xE6,0x24,0xFD,0x78,0xBE,0xF6,0x12,
		0x0D,0xAD,0x40,0x06,0x78,0xBE,0xE6,0xFF,0x80,0x04,0x78,0xBD,0xE6,0xFF,0x78,0xBC,
		0xA6,0x07,0x75,0x1F,0x02,0x78,0xB6,0x76,0x01,0x02,0x02,0x4A,0xE5,0x1F,0x64,0x02,
		0x60,0x03,0x02,0x02,0x2A,0x78,0xBC,0xE6,0xFF,0xC3,0x78,0xBE,0x12,0x0D,0x8B,0x40,
		0x08,0x12,0x0D,0x85,0x50,0x03,0x02,0x02,0x28,0x12,0x0D,0xAD,0x40,0x04,0x7F,0xFF,
		0x80,0x02,0x7F,0x01,0x78,0xBB,0xA6,0x07,0x78,0xB7,0xE6,0x04,0x78,0xBD,0xF6,0x78,
		0xB7,0xE6,0x14,0x78,0xBE,0xF6,0x18,0x12,0x0D,0xAF,0x40,0x04,0xE6,0xFF,0x80,0x02,
		0x7F,0x00,0x78,0xBD,0xA6,0x07,0xD3,0x08,0xE6,0x64,0x80,0x94,0x80,0x40,0x04,0xE6,
		0xFF,0x80,0x02,0x7F,0x00,0x78,0xBE,0xA6,0x07,0xC3,0x18,0xE6,0x64,0x80,0x94,0xB3,
		0x50,0x04,0xE6,0xFF,0x80,0x02,0x7F,0x33,0x78,0xBD,0xA6,0x07,0xC3,0x08,0xE6
	};
	Ov5640_I2cBurstWrite(0x80FF, tmp2, 255);
	unsigned char tmp3[] = {
		0x64,0x80,0x94,0xB3,0x50,0x04,0xE6,0xFF,0x80,0x02,0x7F,0x33,0x78,0xBE,0xA6,0x07,
		0x12,0x0D,0xAD,0x40,0x06,0x78,0xBE,0xE6,0xFF,0x80,0x04,0x78,0xBD,0xE6,0xFF,0x78,
		0xBC,0xA6,0x07,0x75,0x1F,0x03,0x78,0xB6,0x76,0x01,0x80,0x20,0xE5,0x1F,0x64,0x03,
		0x70,0x26,0x78,0xBC,0xE6,0xFF,0xC3,0x78,0xBE,0x12,0x0D,0x8B,0x40,0x05,0x12,0x0D,
		0x85,0x40,0x09,0x78,0xB7,0xE6,0x78,0xBC,0xF6,0x75,0x1F,0x04,0x78,0xBC,0xE6,0x75,
		0xF0,0x05,0xA4,0xF5,0x49,0x02,0x0A,0xCF,0xE5,0x1F,0xB4,0x04,0x10,0x90,0x0E,0x8D,
		0xE4,0x78,0xC1,0x12,0x0D,0x94,0x40,0x02,0xD2,0x37,0x75,0x1F,0x05,0x22,0x30,0x01,
		0x03,0x02,0x04,0xC0,0x30,0x02,0x03,0x02,0x04,0xC0,0x90,0x51,0xA5,0xE0,0x78,0x91,
		0xF6,0xA3,0xE0,0x08,0xF6,0xA3,0xE0,0x08,0xF6,0xE5,0x1F,0x70,0x3C,0x75,0x1E,0x20,
		0xD2,0x35,0x12,0x0C,0x41,0x78,0x7C,0xA6,0x06,0x08,0xA6,0x07,0x78,0x89,0xA6,0x09,
		0x18,0x76,0x01,0x12,0x0C,0x22,0x78,0x4C,0xA6,0x06,0x08,0xA6,0x07,0x78,0x89,0xE6,
		0x78,0x6C,0xF6,0x75,0x1F,0x01,0x78,0x91,0xE6,0x78,0x8E,0xF6,0x78,0x92,0xE6,0x78,
		0x8F,0xF6,0x78,0x93,0xE6,0x78,0x90,0xF6,0x22,0x79,0x8E,0xE7,0xD3,0x78,0x91,0x96,
		0x40,0x05,0xE7,0x96,0xFF,0x80,0x08,0xC3,0x79,0x91,0xE7,0x78,0x8E,0x96,0xFF,0x78,
		0x86,0x76,0x00,0x08,0xA6,0x07,0x79,0x8F,0xE7,0xD3,0x78,0x92,0x96,0x40,0x05,0xE7,
		0x96,0xFF,0x80,0x08,0xC3,0x79,0x92,0xE7,0x78,0x8F,0x96,0xFF,0x12,0x0C,0x55
	};
	Ov5640_I2cBurstWrite(0x81FE, tmp3, 255);
	unsigned char tmp4[] = {
		0x79,0x90,0xE7,0xD3,0x78,0x93,0x96,0x40,0x05,0xE7,0x96,0xFF,0x80,0x08,0xC3,0x79,
		0x93,0xE7,0x78,0x90,0x96,0xFF,0x12,0x0C,0x55,0x12,0x0C,0x22,0x78,0x88,0xE6,0x25,
		0xE0,0x24,0x4C,0xF8,0xA6,0x06,0x08,0xA6,0x07,0x78,0x88,0xE6,0x24,0x6C,0xF8,0xA6,
		0x09,0x78,0x88,0xE6,0x24,0x01,0xFF,0xE4,0x33,0xFE,0xD3,0xEF,0x94,0x0F,0xEE,0x64,
		0x80,0x94,0x80,0x40,0x04,0x7F,0x00,0x80,0x05,0x78,0x88,0xE6,0x04,0xFF,0x78,0x88,
		0xA6,0x07,0xE5,0x1F,0xB4,0x01,0x0A,0xE6,0x60,0x03,0x02,0x04,0xC0,0x75,0x1F,0x02,
		0x22,0x12,0x0C,0x41,0x78,0x7E,0xA6,0x06,0x08,0xA6,0x07,0x12,0x0C,0x41,0x78,0x80,
		0xA6,0x06,0x08,0xA6,0x07,0x78,0x6C,0xE6,0x78,0x8A,0xF6,0x78,0x6C,0xE6,0x78,0x8B,
		0xF6,0x7F,0x01,0xEF,0x25,0xE0,0x24,0x4D,0xF9,0xC3,0x78,0x7F,0xE6,0x97,0x18,0xE6,
		0x19,0x97,0x50,0x0A,0x12,0x0C,0x49,0x78,0x7E,0xA6,0x04,0x08,0xA6,0x05,0x74,0x6C,
		0x2F,0xF9,0x78,0x8A,0xE6,0xC3,0x97,0x50,0x08,0x74,0x6C,0x2F,0xF8,0xE6,0x78,0x8A,
		0xF6,0xEF,0x25,0xE0,0x24,0x4D,0xF9,0xD3,0x78,0x81,0xE6,0x97,0x18,0xE6,0x19,0x97,
		0x40,0x0A,0x12,0x0C,0x49,0x78,0x80,0xA6,0x04,0x08,0xA6,0x05,0x74,0x6C,0x2F,0xF9,
		0x78,0x8B,0xE6,0xD3,0x97,0x40,0x08,0x74,0x6C,0x2F,0xF8,0xE6,0x78,0x8B,0xF6,0x0F,
		0xEF,0x64,0x10,0x70,0x9E,0xC3,0x79,0x7F,0xE7,0x78,0x81,0x96,0xFF,0x19,0xE7,0x18,
		0x96,0x78,0x82,0xF6,0x08,0xA6,0x07,0xC3,0x79,0x8A,0xE7,0x78,0x8B,0x96,0x08
	};
	Ov5640_I2cBurstWrite(0x82FD, tmp4, 255);
	unsigned char tmp5[] = {
		0xF6,0xD3,0x79,0x7F,0xE7,0x78,0x7D,0x96,0x19,0xE7,0x18,0x96,0x40,0x05,0x09,0xE7,
		0x08,0x80,0x06,0xC3,0x79,0x7D,0xE7,0x78,0x7F,0x96,0xFF,0x19,0xE7,0x18,0x96,0xFE,
		0x78,0x84,0xA6,0x06,0x08,0xA6,0x07,0x79,0x8A,0xE7,0xD3,0x78,0x89,0x96,0x40,0x05,
		0xE7,0x96,0xFF,0x80,0x08,0xC3,0x79,0x89,0xE7,0x78,0x8A,0x96,0xFF,0x78,0x8D,0xA6,
		0x07,0xE5,0x1F,0x64,0x02,0x70,0x69,0x90,0x0E,0x8A,0x93,0xFF,0x18,0xE6,0xC3,0x9F,
		0x50,0x72,0x12,0x0C,0x11,0x12,0x0B,0xF6,0x90,0x0E,0x87,0x12,0x0B,0xFF,0x78,0x7E,
		0x12,0x0C,0x32,0x7B,0x04,0x12,0x0B,0xE4,0xC3,0x12,0x06,0x45,0x50,0x56,0x90,0x0E,
		0x8B,0xE4,0x93,0xFF,0x78,0x8D,0xE6,0x9F,0x40,0x02,0x80,0x11,0x90,0x0E,0x89,0xE4,
		0x93,0xFF,0xD3,0x78,0x87,0xE6,0x9F,0x18,0xE6,0x94,0x00,0x40,0x03,0x75,0x1F,0x05,
		0x12,0x0C,0x11,0x12,0x0B,0xF6,0x90,0x0E,0x88,0x12,0x0B,0xFF,0x78,0x7C,0x12,0x0C,
		0x32,0x7B,0x40,0x12,0x0B,0xE4,0xD3,0x12,0x06,0x45,0x40,0x18,0x75,0x1F,0x05,0x22,
		0xE5,0x1F,0xB4,0x05,0x0F,0xD2,0x01,0xC2,0x02,0xE4,0xF5,0x1F,0xF5,0x1E,0xD2,0x35,
		0xD2,0x33,0xD2,0x36,0x22,0xEF,0x8D,0xF0,0xA4,0xA8,0xF0,0xCF,0x8C,0xF0,0xA4,0x28,
		0xCE,0x8D,0xF0,0xA4,0x2E,0xFE,0x22,0xBC,0x00,0x0B,0xBE,0x00,0x29,0xEF,0x8D,0xF0,
		0x84,0xFF,0xAD,0xF0,0x22,0xE4,0xCC,0xF8,0x75,0xF0,0x08,0xEF,0x2F,0xFF,0xEE,0x33,
		0xFE,0xEC,0x33,0xFC,0xEE,0x9D,0xEC,0x98,0x40,0x05,0xFC,0xEE,0x9D,0xFE,0x0F
	};
	Ov5640_I2cBurstWrite(0x83FC, tmp5, 255);
	unsigned char tmp6[] = {
		0xD5,0xF0,0xE9,0xE4,0xCE,0xFD,0x22,0xED,0xF8,0xF5,0xF0,0xEE,0x84,0x20,0xD2,0x1C,
		0xFE,0xAD,0xF0,0x75,0xF0,0x08,0xEF,0x2F,0xFF,0xED,0x33,0xFD,0x40,0x07,0x98,0x50,
		0x06,0xD5,0xF0,0xF2,0x22,0xC3,0x98,0xFD,0x0F,0xD5,0xF0,0xEA,0x22,0xE8,0x8F,0xF0,
		0xA4,0xCC,0x8B,0xF0,0xA4,0x2C,0xFC,0xE9,0x8E,0xF0,0xA4,0x2C,0xFC,0x8A,0xF0,0xED,
		0xA4,0x2C,0xFC,0xEA,0x8E,0xF0,0xA4,0xCD,0xA8,0xF0,0x8B,0xF0,0xA4,0x2D,0xCC,0x38,
		0x25,0xF0,0xFD,0xE9,0x8F,0xF0,0xA4,0x2C,0xCD,0x35,0xF0,0xFC,0xEB,0x8E,0xF0,0xA4,
		0xFE,0xA9,0xF0,0xEB,0x8F,0xF0,0xA4,0xCF,0xC5,0xF0,0x2E,0xCD,0x39,0xFE,0xE4,0x3C,
		0xFC,0xEA,0xA4,0x2D,0xCE,0x35,0xF0,0xFD,0xE4,0x3C,0xFC,0x22,0x75,0xF0,0x08,0x75,
		0x82,0x00,0xEF,0x2F,0xFF,0xEE,0x33,0xFE,0xCD,0x33,0xCD,0xCC,0x33,0xCC,0xC5,0x82,
		0x33,0xC5,0x82,0x9B,0xED,0x9A,0xEC,0x99,0xE5,0x82,0x98,0x40,0x0C,0xF5,0x82,0xEE,
		0x9B,0xFE,0xED,0x9A,0xFD,0xEC,0x99,0xFC,0x0F,0xD5,0xF0,0xD6,0xE4,0xCE,0xFB,0xE4,
		0xCD,0xFA,0xE4,0xCC,0xF9,0xA8,0x82,0x22,0xB8,0x00,0xC1,0xB9,0x00,0x59,0xBA,0x00,
		0x2D,0xEC,0x8B,0xF0,0x84,0xCF,0xCE,0xCD,0xFC,0xE5,0xF0,0xCB,0xF9,0x78,0x18,0xEF,
		0x2F,0xFF,0xEE,0x33,0xFE,0xED,0x33,0xFD,0xEC,0x33,0xFC,0xEB,0x33,0xFB,0x10,0xD7,
		0x03,0x99,0x40,0x04,0xEB,0x99,0xFB,0x0F,0xD8,0xE5,0xE4,0xF9,0xFA,0x22,0x78,0x18,
		0xEF,0x2F,0xFF,0xEE,0x33,0xFE,0xED,0x33,0xFD,0xEC,0x33,0xFC,0xC9,0x33,0xC9
	};
	Ov5640_I2cBurstWrite(0x84FB, tmp6, 255);
	unsigned char tmp7[] = {
		0x10,0xD7,0x05,0x9B,0xE9,0x9A,0x40,0x07,0xEC,0x9B,0xFC,0xE9,0x9A,0xF9,0x0F,0xD8,
		0xE0,0xE4,0xC9,0xFA,0xE4,0xCC,0xFB,0x22,0x75,0xF0,0x10,0xEF,0x2F,0xFF,0xEE,0x33,
		0xFE,0xED,0x33,0xFD,0xCC,0x33,0xCC,0xC8,0x33,0xC8,0x10,0xD7,0x07,0x9B,0xEC,0x9A,
		0xE8,0x99,0x40,0x0A,0xED,0x9B,0xFD,0xEC,0x9A,0xFC,0xE8,0x99,0xF8,0x0F,0xD5,0xF0,
		0xDA,0xE4,0xCD,0xFB,0xE4,0xCC,0xFA,0xE4,0xC8,0xF9,0x22,0xEB,0x9F,0xF5,0xF0,0xEA,
		0x9E,0x42,0xF0,0xE9,0x9D,0x42,0xF0,0xE8,0x9C,0x45,0xF0,0x22,0xE8,0x60,0x0F,0xEF,
		0xC3,0x33,0xFF,0xEE,0x33,0xFE,0xED,0x33,0xFD,0xEC,0x33,0xFC,0xD8,0xF1,0x22,0xE4,
		0x93,0xFC,0x74,0x01,0x93,0xFD,0x74,0x02,0x93,0xFE,0x74,0x03,0x93,0xFF,0x22,0xE6,
		0xFB,0x08,0xE6,0xF9,0x08,0xE6,0xFA,0x08,0xE6,0xCB,0xF8,0x22,0xEC,0xF6,0x08,0xED,
		0xF6,0x08,0xEE,0xF6,0x08,0xEF,0xF6,0x22,0xA4,0x25,0x82,0xF5,0x82,0xE5,0xF0,0x35,
		0x83,0xF5,0x83,0x22,0xD0,0x83,0xD0,0x82,0xF8,0xE4,0x93,0x70,0x12,0x74,0x01,0x93,
		0x70,0x0D,0xA3,0xA3,0x93,0xF8,0x74,0x01,0x93,0xF5,0x82,0x88,0x83,0xE4,0x73,0x74,
		0x02,0x93,0x68,0x60,0xEF,0xA3,0xA3,0xA3,0x80,0xDF,0x90,0x38,0x04,0x78,0x50,0x12,
		0x0B,0xC4,0x90,0x38,0x00,0xE0,0xFE,0xA3,0xE0,0xFD,0xED,0xFF,0xC3,0x12,0x0B,0x7D,
		0x90,0x38,0x10,0x12,0x0B,0x71,0x90,0x38,0x06,0x78,0x52,0x12,0x0B,0xC4,0x90,0x38,
		0x02,0xE0,0xFE,0xA3,0xE0,0xFD,0xED,0xFF,0xC3,0x12,0x0B,0x7D,0x90,0x38,0x12
	};
	Ov5640_I2cBurstWrite(0x85FA, tmp7, 255);
	unsigned char tmp8[] = {
		0x12,0x0B,0x71,0xA3,0xE0,0xB4,0x31,0x07,0x78,0x50,0x79,0x50,0x12,0x0B,0xDA,0x90,
		0x38,0x14,0xE0,0xB4,0x71,0x15,0x78,0x50,0xE6,0xFE,0x08,0xE6,0x78,0x02,0xCE,0xC3,
		0x13,0xCE,0x13,0xD8,0xF9,0x79,0x51,0xF7,0xEE,0x19,0xF7,0x90,0x38,0x15,0xE0,0xB4,
		0x31,0x07,0x78,0x52,0x79,0x52,0x12,0x0B,0xDA,0x90,0x38,0x15,0xE0,0xB4,0x71,0x15,
		0x78,0x52,0xE6,0xFE,0x08,0xE6,0x78,0x02,0xCE,0xC3,0x13,0xCE,0x13,0xD8,0xF9,0x79,
		0x53,0xF7,0xEE,0x19,0xF7,0x79,0x50,0x12,0x0B,0xAC,0x09,0x12,0x0B,0xAC,0xAF,0x45,
		0x12,0x0B,0x62,0x7D,0x50,0x12,0x04,0xD3,0x78,0x58,0xA6,0x06,0x08,0xA6,0x07,0xAF,
		0x43,0x12,0x0B,0x62,0x7D,0x50,0x12,0x04,0xD3,0x78,0x54,0xA6,0x06,0x08,0xA6,0x07,
		0xAF,0x46,0x78,0x52,0x12,0x0B,0x64,0x7D,0x3C,0x12,0x04,0xD3,0x78,0x5A,0xA6,0x06,
		0x08,0xA6,0x07,0xAF,0x44,0x7E,0x00,0x78,0x52,0x12,0x0B,0x66,0x7D,0x3C,0x12,0x04,
		0xD3,0x78,0x56,0xA6,0x06,0x08,0xA6,0x07,0xC3,0x78,0x59,0xE6,0x94,0x08,0x18,0xE6,
		0x94,0x00,0x50,0x05,0x76,0x00,0x08,0x76,0x08,0xC3,0x78,0x5B,0xE6,0x94,0x08,0x18,
		0xE6,0x94,0x00,0x50,0x05,0x76,0x00,0x08,0x76,0x08,0x78,0x58,0x12,0x0B,0x99,0xFF,
		0xD3,0x78,0x55,0xE6,0x9F,0x18,0xE6,0x9E,0x40,0x0E,0x78,0x58,0xE6,0x13,0xFE,0x08,
		0xE6,0x78,0x55,0x12,0x0B,0xCF,0x80,0x04,0x7E,0x00,0x7F,0x00,0x78,0x5C,0x12,0x0B,
		0x91,0xFF,0xD3,0x78,0x57,0xE6,0x9F,0x18,0xE6,0x9E,0x40,0x0E,0x78,0x5A,0xE6
	};
	Ov5640_I2cBurstWrite(0x86F9, tmp8, 255);
	unsigned char tmp9[] = {
		0x13,0xFE,0x08,0xE6,0x78,0x57,0x12,0x0B,0xCF,0x80,0x04,0x7E,0x00,0x7F,0x00,0xE4,
		0xFC,0xFD,0x78,0x60,0x12,0x06,0x86,0x78,0x58,0x12,0x0B,0x99,0x78,0x55,0x26,0xFF,
		0xEE,0x18,0x36,0xFE,0x78,0x64,0x12,0x0B,0x91,0x78,0x57,0x26,0xFF,0xEE,0x18,0x36,
		0xFE,0xE4,0xFC,0xFD,0x78,0x68,0x12,0x06,0x86,0x12,0x0B,0xA1,0x78,0x64,0x12,0x06,
		0x79,0xD3,0x12,0x06,0x45,0x40,0x08,0x12,0x0B,0xA1,0x78,0x64,0x12,0x06,0x86,0x78,
		0x52,0x12,0x0B,0xA3,0x78,0x68,0x12,0x06,0x79,0xD3,0x12,0x06,0x45,0x40,0x0A,0x78,
		0x52,0x12,0x0B,0xA3,0x78,0x68,0x12,0x06,0x86,0x78,0x5F,0xE6,0x90,0x60,0x01,0xF0,
		0x78,0x63,0xE6,0xA3,0xF0,0x78,0x67,0xE6,0xA3,0xF0,0x78,0x53,0xE6,0xA3,0xF0,0x7D,
		0x01,0x78,0x5F,0x12,0x0B,0xBC,0x24,0x01,0x12,0x0B,0x85,0x78,0x63,0x12,0x0B,0xBC,
		0x24,0x02,0x12,0x0B,0x85,0x78,0x67,0x12,0x0B,0xBC,0x24,0x03,0x12,0x0B,0x85,0x78,
		0x6B,0x12,0x0B,0xBC,0x24,0x04,0x12,0x0B,0x85,0x0D,0xBD,0x05,0xD4,0xC2,0x0E,0xC2,
		0x06,0x22,0x85,0x08,0x41,0x90,0x30,0x24,0xE0,0xF5,0x3D,0xA3,0xE0,0xF5,0x3E,0xA3,
		0xE0,0xF5,0x3F,0xA3,0xE0,0xF5,0x40,0xA3,0xE0,0xF5,0x3C,0xD2,0x34,0xE5,0x41,0x12,
		0x06,0x9E,0x09,0x0D,0x03,0x09,0x11,0x04,0x09,0x17,0x05,0x09,0x1A,0x06,0x09,0x1D,
		0x07,0x09,0x26,0x08,0x09,0x37,0x12,0x09,0x4F,0x18,0x09,0x65,0x19,0x09,0x3A,0x1A,
		0x09,0x46,0x1B,0x09,0x8A,0x80,0x09,0x8F,0x81,0x09,0xED,0x8F,0x09,0xDC,0x90
	};
	Ov5640_I2cBurstWrite(0x87F8, tmp9, 255);
	unsigned char tmp10[] = {
		0x09,0xED,0x91,0x09,0xED,0x92,0x09,0xED,0x93,0x09,0xED,0x94,0x09,0xED,0x98,0x09,
		0xEA,0x9F,0x00,0x00,0x0A,0x08,0x12,0x0E,0x93,0x22,0x12,0x0E,0x93,0xD2,0x03,0x22,
		0xD2,0x03,0x22,0xC2,0x03,0x22,0xA2,0x37,0xE4,0x33,0xF5,0x3C,0x02,0x09,0xED,0xC2,
		0x01,0xC2,0x02,0xC2,0x03,0x12,0x0C,0xD4,0x75,0x1E,0x70,0xD2,0x35,0x02,0x09,0xED,
		0x02,0x09,0xD7,0x85,0x40,0x48,0x85,0x3C,0x49,0x12,0x0A,0xCF,0x02,0x09,0xED,0x85,
		0x48,0x40,0x85,0x49,0x3C,0x02,0x09,0xED,0xE4,0xF5,0x22,0xF5,0x23,0x85,0x40,0x31,
		0x85,0x3F,0x30,0x85,0x3E,0x2F,0x85,0x3D,0x2E,0x12,0x0D,0xC1,0x80,0x1F,0x75,0x22,
		0x00,0x75,0x23,0x01,0x74,0xFF,0xF5,0x2D,0xF5,0x2C,0xF5,0x2B,0xF5,0x2A,0x12,0x0D,
		0xC1,0x85,0x2D,0x40,0x85,0x2C,0x3F,0x85,0x2B,0x3E,0x85,0x2A,0x3D,0xE4,0xF5,0x3C,
		0x02,0x09,0xED,0x12,0x0E,0xDC,0x80,0x5E,0x85,0x3D,0x43,0x85,0x3E,0x44,0xE5,0x45,
		0xC3,0x13,0xFF,0xE5,0x43,0xC3,0x9F,0x50,0x02,0x8F,0x43,0xE5,0x46,0xC3,0x13,0xFF,
		0xE5,0x44,0xC3,0x9F,0x50,0x02,0x8F,0x44,0xE5,0x45,0xC3,0x13,0xFF,0xFD,0xE5,0x43,
		0x90,0x0E,0x7F,0x12,0x0E,0xAF,0x40,0x04,0xEE,0x9F,0xF5,0x43,0xE5,0x46,0xC3,0x13,
		0xFF,0xFD,0xE5,0x44,0x90,0x0E,0x80,0x12,0x0E,0xAF,0x40,0x04,0xEE,0x9F,0xF5,0x44,
		0x12,0x06,0xC4,0x80,0x11,0x85,0x40,0x46,0x85,0x3F,0x45,0x85,0x3E,0x44,0x85,0x3D,
		0x43,0x80,0x03,0x02,0x06,0xC4,0x90,0x30,0x24,0xE5,0x3D,0xF0,0xA3,0xE5,0x3E
	};
	Ov5640_I2cBurstWrite(0x88F7, tmp10, 255);
	unsigned char tmp11[] = {
		0xF0,0xA3,0xE5,0x3F,0xF0,0xA3,0xE5,0x40,0xF0,0xA3,0xE5,0x3C,0xF0,0x90,0x30,0x23,
		0xE4,0xF0,0x22,0xC0,0xE0,0xC0,0x83,0xC0,0x82,0xC0,0xD0,0x90,0x3F,0x0C,0xE0,0xF5,
		0x32,0xE5,0x32,0x30,0xE3,0x74,0x30,0x36,0x66,0x90,0x60,0x19,0xE0,0xF5,0x0A,0xA3,
		0xE0,0xF5,0x0B,0x90,0x60,0x1D,0xE0,0xF5,0x14,0xA3,0xE0,0xF5,0x15,0x90,0x60,0x21,
		0xE0,0xF5,0x0C,0xA3,0xE0,0xF5,0x0D,0x90,0x60,0x29,0xE0,0xF5,0x0E,0xA3,0xE0,0xF5,
		0x0F,0x90,0x60,0x31,0xE0,0xF5,0x10,0xA3,0xE0,0xF5,0x11,0x90,0x60,0x39,0xE0,0xF5,
		0x12,0xA3,0xE0,0xF5,0x13,0x30,0x01,0x06,0x30,0x33,0x03,0xD3,0x80,0x01,0xC3,0x92,
		0x09,0x30,0x02,0x06,0x30,0x33,0x03,0xD3,0x80,0x01,0xC3,0x92,0x0A,0x30,0x33,0x0C,
		0x30,0x03,0x09,0x20,0x02,0x06,0x20,0x01,0x03,0xD3,0x80,0x01,0xC3,0x92,0x0B,0x90,
		0x30,0x01,0xE0,0x44,0x40,0xF0,0xE0,0x54,0xBF,0xF0,0xE5,0x32,0x30,0xE1,0x14,0x30,
		0x34,0x11,0x90,0x30,0x22,0xE0,0xF5,0x08,0xE4,0xF0,0x30,0x00,0x03,0xD3,0x80,0x01,
		0xC3,0x92,0x08,0xE5,0x32,0x30,0xE5,0x12,0x90,0x56,0xA1,0xE0,0xF5,0x09,0x30,0x31,
		0x09,0x30,0x05,0x03,0xD3,0x80,0x01,0xC3,0x92,0x0D,0x90,0x3F,0x0C,0xE5,0x32,0xF0,
		0xD0,0xD0,0xD0,0x82,0xD0,0x83,0xD0,0xE0,0x32,0x90,0x0E,0x7D,0xE4,0x93,0xFE,0x74,
		0x01,0x93,0xFF,0xC3,0x90,0x0E,0x7B,0x74,0x01,0x93,0x9F,0xFF,0xE4,0x93,0x9E,0xFE,
		0xE4,0x8F,0x3B,0x8E,0x3A,0xF5,0x39,0xF5,0x38,0xAB,0x3B,0xAA,0x3A,0xA9,0x39
	};
	Ov5640_I2cBurstWrite(0x89F6, tmp11, 255);
	unsigned char tmp12[] = {
		0xA8,0x38,0xAF,0x49,0xFC,0xFD,0xFE,0x12,0x05,0x28,0x12,0x0E,0xC1,0xE4,0x7B,0xFF,
		0xFA,0xF9,0xF8,0x12,0x05,0xB3,0x12,0x0E,0xC1,0x90,0x0E,0x69,0xE4,0x12,0x0E,0xD6,
		0x12,0x0E,0xC1,0xE4,0x85,0x48,0x37,0xF5,0x36,0xF5,0x35,0xF5,0x34,0xAF,0x37,0xAE,
		0x36,0xAD,0x35,0xAC,0x34,0xA3,0x12,0x0E,0xD6,0x8F,0x37,0x8E,0x36,0x8D,0x35,0x8C,
		0x34,0xE5,0x3B,0x45,0x37,0xF5,0x3B,0xE5,0x3A,0x45,0x36,0xF5,0x3A,0xE5,0x39,0x45,
		0x35,0xF5,0x39,0xE5,0x38,0x45,0x34,0xF5,0x38,0xE4,0xF5,0x22,0xF5,0x23,0x85,0x3B,
		0x31,0x85,0x3A,0x30,0x85,0x39,0x2F,0x85,0x38,0x2E,0x02,0x0D,0xC1,0x78,0x50,0x7E,
		0x00,0xE6,0xFC,0x08,0xE6,0xFD,0x12,0x04,0xC1,0x7C,0x00,0x22,0xE0,0xA3,0xE0,0x75,
		0xF0,0x02,0xA4,0xFF,0xAE,0xF0,0xC3,0x08,0xE6,0x9F,0xF6,0x18,0xE6,0x9E,0xF6,0x22,
		0xFF,0xE5,0xF0,0x34,0x60,0x8F,0x82,0xF5,0x83,0xEC,0xF0,0x22,0xE4,0xFC,0xFD,0x12,
		0x06,0x86,0x78,0x5A,0xE6,0xC3,0x13,0xFE,0x08,0xE6,0x13,0x22,0x78,0x50,0xE6,0xFE,
		0x08,0xE6,0xFF,0xE4,0xFC,0xFD,0x22,0xE7,0xC4,0xF8,0x54,0xF0,0xC8,0x68,0xF7,0x09,
		0xE7,0xC4,0x54,0x0F,0x48,0xF7,0x22,0xE6,0xFC,0xED,0x75,0xF0,0x04,0xA4,0x22,0xE0,
		0xFE,0xA3,0xE0,0xFD,0xEE,0xF6,0xED,0x08,0xF6,0x22,0x13,0xFF,0xC3,0xE6,0x9F,0xFF,
		0x18,0xE6,0x9E,0xFE,0x22,0xE6,0xC3,0x13,0xF7,0x08,0xE6,0x13,0x09,0xF7,0x22,0xAD,
		0x39,0xAC,0x38,0xFA,0xF9,0xF8,0x12,0x05,0x28,0x8F,0x3B,0x8E,0x3A,0x8D,0x39
	};
	Ov5640_I2cBurstWrite(0x8AF5, tmp12, 255);
	unsigned char tmp13[] = {
		0x8C,0x38,0xAB,0x37,0xAA,0x36,0xA9,0x35,0xA8,0x34,0x22,0x93,0xFF,0xE4,0xFC,0xFD,
		0xFE,0x12,0x05,0x28,0x8F,0x37,0x8E,0x36,0x8D,0x35,0x8C,0x34,0x22,0x78,0x82,0xE6,
		0xFE,0x08,0xE6,0xFF,0xE4,0x8F,0x37,0x8E,0x36,0xF5,0x35,0xF5,0x34,0x22,0x90,0x0E,
		0x85,0xE4,0x93,0x25,0xE0,0x24,0x0A,0xF8,0xE6,0xFE,0x08,0xE6,0xFF,0x22,0xE6,0xFE,
		0x08,0xE6,0xFF,0xE4,0x8F,0x3B,0x8E,0x3A,0xF5,0x39,0xF5,0x38,0x22,0x78,0x4C,0xE6,
		0xFE,0x08,0xE6,0xFF,0x22,0xEF,0x25,0xE0,0x24,0x4C,0xF8,0xE6,0xFC,0x08,0xE6,0xFD,
		0x22,0x78,0x87,0xEF,0x26,0xF6,0x18,0xE4,0x36,0xF6,0x22,0x75,0x89,0x03,0x75,0xA8,
		0x01,0x75,0xB8,0x04,0x75,0x34,0xFF,0x75,0x35,0x0E,0x75,0x36,0x15,0x75,0x37,0x0D,
		0x12,0x0D,0x45,0x12,0x00,0x09,0x12,0x0E,0xDC,0x12,0x00,0x06,0xD2,0x00,0xD2,0x34,
		0xD2,0xAF,0x75,0x34,0xFF,0x75,0x35,0x0E,0x75,0x36,0x49,0x75,0x37,0x03,0x12,0x0D,
		0x45,0x30,0x08,0x09,0xC2,0x34,0x12,0x08,0xAA,0xC2,0x08,0xD2,0x34,0x30,0x0B,0x09,
		0xC2,0x36,0x12,0x02,0x6C,0xC2,0x0B,0xD2,0x36,0x30,0x09,0x09,0xC2,0x36,0x12,0x00,
		0x0E,0xC2,0x09,0xD2,0x36,0x30,0x0E,0x03,0x12,0x06,0xC4,0x30,0x35,0xD3,0x90,0x30,
		0x29,0xE5,0x1E,0xF0,0xB4,0x10,0x05,0x90,0x30,0x23,0xE4,0xF0,0xC2,0x35,0x80,0xC1,
		0xE4,0xF5,0x49,0x90,0x0E,0x77,0x93,0xFF,0xE4,0x8F,0x37,0xF5,0x36,0xF5,0x35,0xF5,
		0x34,0xAF,0x37,0xAE,0x36,0xAD,0x35,0xAC,0x34,0x90,0x0E,0x6A,0x12,0x0E,0xD6
	};
	Ov5640_I2cBurstWrite(0x8BF4, tmp13, 255);
	unsigned char tmp14[] = {
		0x8F,0x37,0x8E,0x36,0x8D,0x35,0x8C,0x34,0x90,0x0E,0x72,0x12,0x06,0x69,0xEF,0x45,
		0x37,0xF5,0x37,0xEE,0x45,0x36,0xF5,0x36,0xED,0x45,0x35,0xF5,0x35,0xEC,0x45,0x34,
		0xF5,0x34,0xE4,0xF5,0x22,0xF5,0x23,0x85,0x37,0x31,0x85,0x36,0x30,0x85,0x35,0x2F,
		0x85,0x34,0x2E,0x12,0x0D,0xC1,0xE4,0xF5,0x22,0xF5,0x23,0x90,0x0E,0x72,0x12,0x0E,
		0xCA,0x12,0x0D,0xC1,0xE4,0xF5,0x22,0xF5,0x23,0x90,0x0E,0x6E,0x12,0x0E,0xCA,0x02,
		0x0D,0xC1,0xAE,0x35,0xAF,0x36,0xE4,0xFD,0xED,0xC3,0x95,0x37,0x50,0x33,0x12,0x0F,
		0x18,0xE4,0x93,0xF5,0x38,0x74,0x01,0x93,0xF5,0x39,0x45,0x38,0x60,0x23,0x85,0x39,
		0x82,0x85,0x38,0x83,0xE0,0xFC,0x12,0x0F,0x18,0x74,0x03,0x93,0x52,0x04,0x12,0x0F,
		0x18,0x74,0x02,0x93,0x42,0x04,0x85,0x39,0x82,0x85,0x38,0x83,0xEC,0xF0,0x0D,0x80,
		0xC7,0x22,0x78,0xBC,0xE6,0xD3,0x08,0xFF,0xE6,0x64,0x80,0xF8,0xEF,0x64,0x80,0x98,
		0x22,0x93,0xFF,0x7E,0x00,0xE6,0xFC,0x08,0xE6,0xFD,0x12,0x04,0xC1,0x78,0xBF,0xE6,
		0xFC,0x08,0xE6,0xFD,0xD3,0xEF,0x9D,0xEE,0x9C,0x22,0x78,0xBB,0xD3,0xE6,0x64,0x80,
		0x94,0x80,0x22,0x25,0xE0,0x24,0x0A,0xF8,0xE6,0xFE,0x08,0xE6,0xFF,0x22,0xA2,0xAF,
		0x92,0x32,0xC2,0xAF,0xE5,0x23,0x45,0x22,0x90,0x0E,0x5D,0x60,0x0E,0x12,0x0D,0xF2,
		0xE0,0xF5,0x2C,0x12,0x0D,0xEF,0xE0,0xF5,0x2D,0x80,0x0C,0x12,0x0D,0xF2,0xE5,0x30,
		0xF0,0x12,0x0D,0xEF,0xE5,0x31,0xF0,0xA2,0x32,0x92,0xAF,0x22,0x90,0x0E,0x5F
	};
	Ov5640_I2cBurstWrite(0x8CF3, tmp14, 255);
	unsigned char tmp15[] = {
		0xE4,0x93,0xFE,0x74,0x01,0x93,0xF5,0x82,0x8E,0x83,0x22,0x00,0x00,0x00,0x11,0x09,
		0x26,0x12,0x31,0x43,0x53,0x54,0x45,0x20,0x20,0x20,0x20,0x20,0x13,0x01,0x10,0x00,
		0x56,0x40,0x1A,0x30,0x29,0x7E,0x00,0x30,0x04,0x20,0xDF,0x30,0x05,0x40,0xBF,0x50,
		0x03,0x00,0xFD,0x50,0x27,0x01,0xFE,0x60,0x00,0x11,0x00,0x3F,0x05,0x30,0x00,0x3F,
		0x06,0x22,0x00,0x3F,0x01,0x2A,0x00,0x3F,0x02,0x00,0x00,0x36,0x06,0x07,0x00,0x3F,
		0x0B,0x0F,0xF0,0x00,0x00,0x00,0x00,0x30,0x01,0x40,0xBF,0x30,0x01,0x00,0xBF,0x30,
		0x29,0x70,0x00,0x3A,0x00,0x00,0xFF,0x3A,0x00,0x00,0xFF,0x36,0x03,0x36,0x02,0x41,
		0x44,0x58,0x20,0x18,0x10,0x0A,0x04,0x04,0x00,0x03,0xFF,0x64,0x00,0x00,0x80,0x00,
		0x00,0x00,0x00,0x00,0x00,0x02,0x04,0x06,0x00,0x03,0x98,0x00,0xCC,0x50,0x3C,0x28,
		0x1E,0x10,0x10,0x02,0x00,0x10,0x0C,0x10,0x04,0x0C,0x6E,0x06,0x05,0x00,0xA5,0x5A,
		0x00,0xD2,0x01,0xC2,0x02,0xE4,0xF5,0x1F,0xF5,0x1E,0xD2,0x35,0xD2,0x33,0xD2,0x36,
		0xD2,0x01,0xC2,0x02,0xF5,0x1F,0xF5,0x1E,0xD2,0x35,0xD2,0x33,0x22,0x2D,0xFD,0xE4,
		0x33,0xFC,0xE4,0x93,0xFE,0xFB,0xD3,0xED,0x9B,0x74,0x80,0xF8,0x6C,0x98,0x22,0x8F,
		0x3B,0x8E,0x3A,0x8D,0x39,0x8C,0x38,0x22,0x12,0x06,0x69,0x8F,0x31,0x8E,0x30,0x8D,
		0x2F,0x8C,0x2E,0x22,0x93,0xF9,0xF8,0x02,0x06,0x56,0x90,0x0E,0x81,0x12,0x06,0x69,
		0x8F,0x46,0x8E,0x45,0x8D,0x44,0x8C,0x43,0xD2,0x06,0x30,0x06,0x03,0xD3,0x80
	};
	Ov5640_I2cBurstWrite(0x8DF2, tmp15, 255);
	unsigned char tmp16[] = {
		0x01,0xC3,0x92,0x0E,0x22,0xC0,0xE0,0xC0,0x83,0xC0,0x82,0x90,0x3F,0x0D,0xE0,0xF5,
		0x33,0xE5,0x33,0xF0,0xD0,0x82,0xD0,0x83,0xD0,0xE0,0x32,0x78,0x7F,0xE4,0xF6,0xD8,
		0xFD,0x75,0x81,0xCB,0x02,0x0C,0x5F,0x8F,0x82,0x8E,0x83,0x75,0xF0,0x04,0xED,0x02,
		0x06,0x92
	};
	Ov5640_I2cBurstWrite(0x8EF1, tmp16, 50);

	Ov5640_I2cWrite(0x3022, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3023, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3024, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3025, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3026, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3027, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3028, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3029, 0x7F);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3000, 0x00);		// SYSTEM_RESET00
	Ov5640_I2cRead(0x3008, &reg_value);	// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3008, 0x42);		// SYSTEM CTROL0
}

void Ov5640_PowerUp2(void) {
	unsigned char reg_value;
	Ov5640_I2cRead(0x3008, &reg_value);	// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3008, 0x42);		// SYSTEM CTROL0
}

void Ov5640_DeviceSelect(void) {
	unsigned char reg_value;

	Ov5640_I2cWrite(0x3008, 0x42);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3103, 0x03);		// SCCB SYSTEM CTRL1
	Ov5640_I2cWrite(0x3017, 0x00);		// PAD OUTPUT ENABLE 01
	Ov5640_I2cWrite(0x3018, 0x00);		// PAD OUTPUT ENABLE 02
	Ov5640_I2cWrite(0x3034, 0x18);		// SC PLL CONTRL0
	Ov5640_I2cWrite(0x3035, 0x11);		// SC PLL CONTRL1
	Ov5640_I2cWrite(0x3036, 0x54);		// SC PLL CONTRL2
	Ov5640_I2cWrite(0x3037, 0x13);		// SC PLL CONTRL3
	Ov5640_I2cWrite(0x3108, 0x01);		// SYSTEM ROOT DIVIDER
	Ov5640_I2cWrite(0x3820, 0x46);		// TIMING TC REG20
	Ov5640_I2cWrite(0x3821, 0x01);		// TIMING TC REG21
	Ov5640_I2cWrite(0x3814, 0x11);		// TIMING X INC
	Ov5640_I2cWrite(0x3815, 0x11);		// TIMING Y INC
	Ov5640_I2cWrite(0x3800, 0x01);		// TIMING HS
	Ov5640_I2cWrite(0x3801, 0x50);		// TIMING HS
	Ov5640_I2cWrite(0x3802, 0x01);		// TIMING VS
	Ov5640_I2cWrite(0x3803, 0xB2);		// TIMING VS
	Ov5640_I2cWrite(0x3804, 0x08);		// TIMING HW
	Ov5640_I2cWrite(0x3805, 0xEF);		// TIMING HW
	Ov5640_I2cWrite(0x3806, 0x05);		// TIMING VH
	Ov5640_I2cWrite(0x3807, 0xF1);		// TIMING VH
	Ov5640_I2cWrite(0x3808, 0x07);		// TIMING DVPHO
	Ov5640_I2cWrite(0x3809, 0x80);		// TIMING DVPHO
	Ov5640_I2cWrite(0x380A, 0x04);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380B, 0x38);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380C, 0x09);		// TIMING HTS
	Ov5640_I2cWrite(0x380D, 0xC4);		// TIMING HTS
	Ov5640_I2cWrite(0x380E, 0x04);		// TIMING VTS
	Ov5640_I2cWrite(0x380F, 0x60);		// TIMING VTS
	Ov5640_I2cWrite(0x3810, 0x00);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3811, 0x10);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3812, 0x00);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3813, 0x04);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3618, 0x04);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3612, 0x2B);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3708, 0x64);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3709, 0x12);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x370C, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3A02, 0x04);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A03, 0x60);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A08, 0x01);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A09, 0x50);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A0A, 0x01);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0B, 0x18);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0E, 0x03);		// AEC CTRL0E
	Ov5640_I2cWrite(0x3A0D, 0x04);		// AEC CTRL0D
	Ov5640_I2cWrite(0x3A14, 0x04);		// AEC MAX EXPO(50HZ)
	Ov5640_I2cWrite(0x3A15, 0x60);		// AEC MAX EXPO(50HZ)
	Ov5640_I2cWrite(0x3002, 0x1C);		// SYSTEM RESET02
	Ov5640_I2cWrite(0x3006, 0xC3);		// CLOCK ENABLE02
	Ov5640_I2cWrite(0x300E, 0x45);		// MIPI CONTROL 00
	Ov5640_I2cWrite(0x302E, 0x08);		// SYSTEM CONTROL
	Ov5640_I2cWrite(0x4300, 0x30);		// FORMAT CONTROL00
	Ov5640_I2cWrite(0x501F, 0x00);		// FORMAT MUX CONTROL
	Ov5640_I2cWrite(0x4713, 0x02);		// JPG MODE SELECT
	Ov5640_I2cWrite(0x4407, 0x04);		// JPEG CTRL07
	Ov5640_I2cWrite(0x460B, 0x37);		// DEBUG MODE
	Ov5640_I2cWrite(0x460C, 0x20);		// VFIFO CTRL0C
	Ov5640_I2cWrite(0x4827, 0x16);		// MIN HS PREPARE L
	Ov5640_I2cWrite(0x3824, 0x04);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x4800, 0x34);		// MIPI CTRL 00
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x4740, 0x21);		// POLARITY CTRL00
	Ov5640_I2cRead(0x3008, &reg_value);	// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0

	Ov5640_I2cWrite(0x3023, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3022, 0x04);		// INVALID ADDRESS
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
}

void Ov5640_YUY2_640_480_60FPS(void) {
	unsigned char reg_value;

	Ov5640_I2cWrite(0x3103, 0x03);		// SCCB SYSTEM CTRL1
	Ov5640_I2cWrite(0x3035, 0x12);		// SC PLL CONTRL1
	Ov5640_I2cWrite(0x3036, 0x6F);		// SC PLL CONTRL2
	Ov5640_I2cWrite(0x3037, 0x13);		// SC PLL CONTRL3
	Ov5640_I2cWrite(0x3108, 0x01);		// SYSTEM ROOT DIVIDER
	Ov5640_I2cWrite(0x3820, 0x47);		// TIMING TC REG20
	Ov5640_I2cWrite(0x3821, 0x01);		// TIMING TC REG21
	Ov5640_I2cWrite(0x3814, 0x31);		// TIMING X INC
	Ov5640_I2cWrite(0x3815, 0x31);		// TIMING Y INC
	Ov5640_I2cWrite(0x3800, 0x00);		// TIMING HS
	Ov5640_I2cWrite(0x3801, 0x00);		// TIMING HS
	Ov5640_I2cWrite(0x3802, 0x00);		// TIMING VS
	Ov5640_I2cWrite(0x3803, 0x04);		// TIMING VS
	Ov5640_I2cWrite(0x3804, 0x0A);		// TIMING HW
	Ov5640_I2cWrite(0x3805, 0x3F);		// TIMING HW
	Ov5640_I2cWrite(0x3806, 0x07);		// TIMING VH
	Ov5640_I2cWrite(0x3807, 0x9B);		// TIMING VH
	Ov5640_I2cWrite(0x3808, 0x02);		// TIMING DVPHO
	Ov5640_I2cWrite(0x3809, 0x80);		// TIMING DVPHO
	Ov5640_I2cWrite(0x380A, 0x01);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380B, 0xE0);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380C, 0x07);		// TIMING HTS
	Ov5640_I2cWrite(0x380D, 0x68);		// TIMING HTS
	Ov5640_I2cWrite(0x380E, 0x03);		// TIMING VTS
	Ov5640_I2cWrite(0x380F, 0xD8);		// TIMING VTS
	Ov5640_I2cWrite(0x3810, 0x00);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3811, 0x10);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3812, 0x00);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3813, 0x06);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3618, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3612, 0x29);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3708, 0x64);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3709, 0x52);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x370C, 0x03);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3A02, 0x03);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A03, 0xD8);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A08, 0x01);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A09, 0x27);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A0A, 0x00);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0B, 0xF6);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0E, 0x03);		// AEC CTRL0E
	Ov5640_I2cWrite(0x3A0D, 0x04);		// AEC CTRL0D
	Ov5640_I2cWrite(0x3A14, 0x03);		// AEC MAX EXPO(50HZ)
	Ov5640_I2cWrite(0x3A15, 0xD8);		// AEC MAX EXPO(50HZ)
	//Ov5640_I2cWrite(0x300E, 0x25);		// MIPI CONTROL 00
 	Ov5640_I2cWrite(0x300E, 0x45);		// MIPI CONTROL 00 -> 2-lane mode
	Ov5640_I2cWrite(0x302E, 0x08);		// SYSTEM CONTROL
	Ov5640_I2cWrite(0x460C, 0x22);		// VFIFO CTRL0C
	Ov5640_I2cWrite(0x4827, 0x16);		// MIN HS PREPARE L
	Ov5640_I2cWrite(0x3824, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x4300, 0x30);		// FORMAT CONTROL00
	Ov5640_I2cWrite(0x501F, 0x00);		// FORMAT MUX CONTROL
	Ov5640_I2cWrite(0x5001, 0xA3);		// ISP CONTROL 01
	Ov5640_I2cWrite(0x4800, 0x34);		// MIPI CTRL 00
	//Ov5640_I2cWrite(0x4800, 0x04);		// MIPI CTRL 00 -> clock lane gate, line short packet
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x0000, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x0000, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x4740, 0x21);		// POLARITY CTRL00
	Ov5640_I2cRead(0x3008, &reg_value);	// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0

	Ov5640_I2cWrite(0x3023, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3022, 0x04);		// INVALID ADDRESS
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
}

// Ov5640_DeviceSelectとの差分を追加
void Ov5640_YUY2_640_480_60FPS2(void) {
	unsigned char reg_value;

	// added
	//////////////////////////////////////////////////////
	Ov5640_I2cWrite(0x3008, 0x42);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3103, 0x03);		// SCCB SYSTEM CTRL1
	Ov5640_I2cWrite(0x3017, 0x00);		// PAD OUTPUT ENABLE 01
	Ov5640_I2cWrite(0x3018, 0x00);		// PAD OUTPUT ENABLE 02
	Ov5640_I2cWrite(0x3034, 0x18);		// SC PLL CONTRL0
	//////////////////////////////////////////////////////

	Ov5640_I2cWrite(0x3103, 0x03);		// SCCB SYSTEM CTRL1
	Ov5640_I2cWrite(0x3035, 0x12);		// SC PLL CONTRL1
	Ov5640_I2cWrite(0x3036, 0x6F);		// SC PLL CONTRL2
	Ov5640_I2cWrite(0x3037, 0x13);		// SC PLL CONTRL3
	Ov5640_I2cWrite(0x3108, 0x01);		// SYSTEM ROOT DIVIDER
	Ov5640_I2cWrite(0x3820, 0x47);		// TIMING TC REG20
	Ov5640_I2cWrite(0x3821, 0x01);		// TIMING TC REG21
	Ov5640_I2cWrite(0x3814, 0x31);		// TIMING X INC
	Ov5640_I2cWrite(0x3815, 0x31);		// TIMING Y INC
	Ov5640_I2cWrite(0x3800, 0x00);		// TIMING HS
	Ov5640_I2cWrite(0x3801, 0x00);		// TIMING HS
	Ov5640_I2cWrite(0x3802, 0x00);		// TIMING VS
	Ov5640_I2cWrite(0x3803, 0x04);		// TIMING VS
	Ov5640_I2cWrite(0x3804, 0x0A);		// TIMING HW
	Ov5640_I2cWrite(0x3805, 0x3F);		// TIMING HW
	Ov5640_I2cWrite(0x3806, 0x07);		// TIMING VH
	Ov5640_I2cWrite(0x3807, 0x9B);		// TIMING VH
	Ov5640_I2cWrite(0x3808, 0x02);		// TIMING DVPHO
	Ov5640_I2cWrite(0x3809, 0x80);		// TIMING DVPHO
	Ov5640_I2cWrite(0x380A, 0x01);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380B, 0xE0);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380C, 0x07);		// TIMING HTS
	Ov5640_I2cWrite(0x380D, 0x68);		// TIMING HTS
	Ov5640_I2cWrite(0x380E, 0x03);		// TIMING VTS
	Ov5640_I2cWrite(0x380F, 0xD8);		// TIMING VTS
	Ov5640_I2cWrite(0x3810, 0x00);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3811, 0x10);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3812, 0x00);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3813, 0x06);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3618, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3612, 0x29);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3708, 0x64);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3709, 0x52);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x370C, 0x03);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3A02, 0x03);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A03, 0xD8);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A08, 0x01);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A09, 0x27);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A0A, 0x00);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0B, 0xF6);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0E, 0x03);		// AEC CTRL0E
	Ov5640_I2cWrite(0x3A0D, 0x04);		// AEC CTRL0D
	Ov5640_I2cWrite(0x3A14, 0x03);		// AEC MAX EXPO(50HZ)
	Ov5640_I2cWrite(0x3A15, 0xD8);		// AEC MAX EXPO(50HZ)
	//Ov5640_I2cWrite(0x300E, 0x25);		// MIPI CONTROL 00
 	Ov5640_I2cWrite(0x300E, 0x45);		// MIPI CONTROL 00 -> 2-lane mode
	Ov5640_I2cWrite(0x302E, 0x08);		// SYSTEM CONTROL
	Ov5640_I2cWrite(0x460C, 0x22);		// VFIFO CTRL0C
	Ov5640_I2cWrite(0x4827, 0x16);		// MIN HS PREPARE L
	Ov5640_I2cWrite(0x3824, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x4300, 0x30);		// FORMAT CONTROL00
	Ov5640_I2cWrite(0x501F, 0x00);		// FORMAT MUX CONTROL
	Ov5640_I2cWrite(0x5001, 0xA3);		// ISP CONTROL 01
	Ov5640_I2cWrite(0x4800, 0x34);		// MIPI CTRL 00
	//Ov5640_I2cWrite(0x4800, 0x04);		// MIPI CTRL 00 -> clock lane gate, line short packet
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x0000, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x0000, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x4740, 0x21);		// POLARITY CTRL00
	Ov5640_I2cRead(0x3008, &reg_value);	// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0

	Ov5640_I2cWrite(0x3023, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3022, 0x04);		// INVALID ADDRESS
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
}

// Ov5640_DeviceSelectとの差分を追加
void Ov5640_YUY2_640_480_60FPS3(void) {
	unsigned char reg_value;

	// added
	//////////////////////////////////////////////////////
	Ov5640_I2cWrite(0x3008, 0x42);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3103, 0x03);		// SCCB SYSTEM CTRL1
	Ov5640_I2cWrite(0x3017, 0x00);		// PAD OUTPUT ENABLE 01
	Ov5640_I2cWrite(0x3018, 0x00);		// PAD OUTPUT ENABLE 02
	Ov5640_I2cWrite(0x3034, 0x18);		// SC PLL CONTRL0
	//////////////////////////////////////////////////////

	Ov5640_I2cWrite(0x3103, 0x03);		// SCCB SYSTEM CTRL1
	Ov5640_I2cWrite(0x3035, 0x12);		// SC PLL CONTRL1
	Ov5640_I2cWrite(0x3036, 0x6F);		// SC PLL CONTRL2
	Ov5640_I2cWrite(0x3037, 0x13);		// SC PLL CONTRL3
	Ov5640_I2cWrite(0x3108, 0x01);		// SYSTEM ROOT DIVIDER
	Ov5640_I2cWrite(0x3820, 0x47);		// TIMING TC REG20
	Ov5640_I2cWrite(0x3821, 0x01);		// TIMING TC REG21
	//Ov5640_I2cWrite(0x3821, 0x06);		// TIMING TC REG21
	Ov5640_I2cWrite(0x3814, 0x31);		// TIMING X INC
	Ov5640_I2cWrite(0x3815, 0x31);		// TIMING Y INC
	//Ov5640_I2cWrite(0x3814, 0x62);		// TIMING X INC
	//Ov5640_I2cWrite(0x3815, 0x62);		// TIMING Y INC
	//Ov5640_I2cWrite(0x3814, 0x11);		// TIMING X INC
	//Ov5640_I2cWrite(0x3815, 0x11);		// TIMING Y INC
	Ov5640_I2cWrite(0x3800, 0x00);		// TIMING HS
	Ov5640_I2cWrite(0x3801, 0x00);		// TIMING HS
	Ov5640_I2cWrite(0x3802, 0x00);		// TIMING VS
	Ov5640_I2cWrite(0x3803, 0x04);		// TIMING VS
	Ov5640_I2cWrite(0x3804, 0x0A);		// TIMING HW
	Ov5640_I2cWrite(0x3805, 0x3F);		// TIMING HW
	Ov5640_I2cWrite(0x3806, 0x07);		// TIMING VH
	Ov5640_I2cWrite(0x3807, 0x9B);		// TIMING VH
	Ov5640_I2cWrite(0x3808, 0x02);		// TIMING DVPHO
	Ov5640_I2cWrite(0x3809, 0x80);		// TIMING DVPHO
	Ov5640_I2cWrite(0x380A, 0x01);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380B, 0xE0);		// TIMING DVPVO
	Ov5640_I2cWrite(0x380C, 0x07);		// TIMING HTS
	Ov5640_I2cWrite(0x380D, 0x68);		// TIMING HTS
	Ov5640_I2cWrite(0x380E, 0x03);		// TIMING VTS
	Ov5640_I2cWrite(0x380F, 0xD8);		// TIMING VTS
	Ov5640_I2cWrite(0x3810, 0x00);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3811, 0x10);		// TIMING HOFFSET
	Ov5640_I2cWrite(0x3812, 0x00);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3813, 0x06);		// TIMING VOFFSET
	Ov5640_I2cWrite(0x3618, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3612, 0x29);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3708, 0x64);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3709, 0x52);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x370C, 0x03);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3A02, 0x03);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A03, 0xD8);		// AEC MAX EXPO(60HZ)
	Ov5640_I2cWrite(0x3A08, 0x01);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A09, 0x27);		// AEC B50 STEP
	Ov5640_I2cWrite(0x3A0A, 0x00);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0B, 0xF6);		// AEC B60 STEP
	Ov5640_I2cWrite(0x3A0E, 0x03);		// AEC CTRL0E
	Ov5640_I2cWrite(0x3A0D, 0x04);		// AEC CTRL0D
	Ov5640_I2cWrite(0x3A14, 0x03);		// AEC MAX EXPO(50HZ)
	Ov5640_I2cWrite(0x3A15, 0xD8);		// AEC MAX EXPO(50HZ)
	//Ov5640_I2cWrite(0x300E, 0x25);		// MIPI CONTROL 00
 	Ov5640_I2cWrite(0x300E, 0x45);		// MIPI CONTROL 00 -> 2-lane mode
	Ov5640_I2cWrite(0x302E, 0x08);		// SYSTEM CONTROL
	Ov5640_I2cWrite(0x460C, 0x22);		// VFIFO CTRL0C
	Ov5640_I2cWrite(0x4827, 0x16);		// MIN HS PREPARE L
	Ov5640_I2cWrite(0x3824, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x4300, 0x30);		// FORMAT CONTROL00
	Ov5640_I2cWrite(0x501F, 0x00);		// FORMAT MUX CONTROL
	Ov5640_I2cWrite(0x5001, 0xA3);		// ISP CONTROL 01
	Ov5640_I2cWrite(0x4800, 0x34);		// MIPI CTRL 00
	//Ov5640_I2cWrite(0x4800, 0x04);		// MIPI CTRL 00 -> clock lane gate, line short packet
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0
	Ov5640_I2cWrite(0x0000, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x0000, 0x00);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x4740, 0x21);		// POLARITY CTRL00
	Ov5640_I2cRead(0x3008, &reg_value);	// SYSTEM CTROL0
	Ov5640_I2cWrite(0x3008, 0x02);		// SYSTEM CTROL0

	Ov5640_I2cWrite(0x3023, 0x01);		// INVALID ADDRESS
	Ov5640_I2cWrite(0x3022, 0x04);		// INVALID ADDRESS
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
	usleep(100000); // 100ms wait
	Ov5640_I2cRead(0x3023, &reg_value);	// INVALID ADDRESS
}

void Ov5640_SetExposureAuto() {
	Ov5640_I2cWrite(0x3503, 0x00);	// AEC PK MANUAL
	Ov5640_I2cWrite(0x350C, 0x0B);	// AEC PK VTS
	Ov5640_I2cWrite(0x350D, 0x7F);	// AEC PK VTS
}

void Ov5640_SetExposureManual(int level) {

	// Set to manual exposure mode
	Ov5640_I2cWrite(0x3503, 0x03);	// AEC PK MANUAL
	Ov5640_I2cWrite(0x350C, 0x00);	// AEC PK VTS
	Ov5640_I2cWrite(0x350D, 0x00);	// AEC PK VTS

	// Set threshold values
	Ov5640_I2cWrite(0x3A0F, 0x30);	// AEC CTRL0F (Enter High)
	Ov5640_I2cWrite(0x3A10, 0x28);	// AEC CTRL10 (Enter Low)
	Ov5640_I2cWrite(0x3A1B, 0x30);	// AEC CTRL1B (Go Out High)
	Ov5640_I2cWrite(0x3A1E, 0x26);	// AEC CTRL1E (Go Out Low)
	Ov5640_I2cWrite(0x3A11, 0x60);	// AEC CTRL11 (Step High)
	Ov5640_I2cWrite(0x3A1F, 0x14);	// AEC CTRL1F (Step Low)

	// Set Exposure and Real Gain
	int exposure, real_gain;
	switch(level) {
	case 0: // -13
		exposure = 9440;
		real_gain = 72;
		break;
	case 1: // -12
		exposure = 9440;
		real_gain = 87;
		break;
	case 2:// -11
		exposure = 9440;
		real_gain = 102;
		break;
	case 3: // -10
		exposure = 9440;
		real_gain = 117;
		break;
	case 4: // -9 (default)
		exposure = 14160;
		real_gain = 88;
		break;
	case 5: // -8
		exposure = 14160;
		real_gain = 98;
		break;
	case 6: // -7
		exposure = 14160;
		real_gain = 108;
		break;
	case 7: // -6
		exposure = 14160;
		real_gain = 118;
		break;
	case 8: // -5
		exposure = 14160;
		real_gain = 128;
		break;
	default: // -9 (default)
		exposure = 14160;
		real_gain = 88;
		break;
	}

	// AEC PK EXPOSURE (High/Mid/Low)
	Ov5640_I2cWrite(0x3500, (unsigned char)((exposure & 0xFF0000) >> 16));
	Ov5640_I2cWrite(0x3501, (unsigned char)((exposure & 0x00FF00) >>  8));
	Ov5640_I2cWrite(0x3502, (unsigned char)((exposure & 0x0000FF)      ));

	// AEC PK REAL GAIN (High/Low)
	Ov5640_I2cWrite(0x350A, (unsigned char)((real_gain & 0xFF00) >> 8));
	Ov5640_I2cWrite(0x350B, (unsigned char)((real_gain & 0x00FF)     ));
}

void Ov5640_SetBrightness(int br) {
	unsigned char val;
	if (br >= 255) {
		val = 255; // upper limit
	} else if (br >= 0) {
		val = br; // positive value
	} else if (br >= -255) {
		val = -br; // negative value
	} else {
		val = 255; // lower limit
	}

	Ov5640_I2cWrite(0x5580, 0x06);		// Contrast/Saturation Enable
	Ov5640_I2cWrite(0x5001, 0xA7);		// SED/Scale/UV average/Color matrix/AWB Enable
	Ov5640_I2cWrite(0x5587, val);		// Y bright for contrast
	if (br >= 0) {
		Ov5640_I2cWrite(0x5588, 0x01);	// Keep Y bright sign
	} else {
		Ov5640_I2cWrite(0x5588, 0x09);	// Negative Y bright sign
	}
}

//void Ov5640_BrightnessControl(unsigned char* img, int wdt, int hgt)
void Ov5640_BrightnessControl(
	struct UVC_APP_DATA *app_data,
	struct REMOTE_SETTING *remoteSetting,
	int wdt, int hgt, int *av, int *br)
{
	static int brightness = 16;

	int sum = 0;
	int num = 0;
	if ((remoteSetting->usbOutput == USB_OUTPUT_STEREO_RECT) ||
		(remoteSetting->returnData == RETURN_DATA_STEREO_RECT))
	{
		// Rectification
		u8 *src = (app_data->bank == 0) ? (u8*)BUF_RECT_A : (u8*)BUF_RECT_B;
		for (int row = 0; row < 480; row+=4) {
			for (int col = 0; col < 640; col+=4) {
				unsigned int src_addr = row * 640 + col;
				sum += src[src_addr];
				num++;
			}
		}
	} else if ((remoteSetting->usbOutput == USB_OUTPUT_RAW_FRAME) ||
		(remoteSetting->returnData == RETURN_DATA_RAW_FRAME))
	{
		// Frame Grabber
		u8 *src = (app_data->bank == 0) ? (u8*)BUF_GRB_A : (u8*)BUF_GRB_B;
		for (int row = 0; row < 480; row+=4) {
			for (int col = 0; col < 640; col+=4) {
				int src_addr = (row * 1280 + col) * 2 + 1;
				sum += src[src_addr];
				num++;
			}
		}
	} else {
		return;
	}

	double ave = sum / (double)(num);

	double dif = ave - 128.0;

	brightness -= dif;
	if (brightness >= 255) brightness = 255;
	else if (brightness <= -255) brightness = -255;

	Ov5640_SetBrightness(brightness);

	//int ave_int = (int)ave;
	//xil_printf( "[%3d/%3d] \r\n", ave_int, brightness);

	*av = (int)ave;
	*br = brightness;
}

